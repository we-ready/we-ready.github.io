<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.7929b149196a9d0c0ac2.css" id="gatsby-global-css">*{margin:0;padding:0;box-sizing:border-box}body{background:transparent}</style><meta name="generator" content="Gatsby 2.32.4"/><style data-styled="" data-styled-version="5.2.1">.cwuJxU{width:100%;}/*!sc*/
data-styled.g1[id="elements__Section-sc-1wyezfv-0"]{content:"cwuJxU,"}/*!sc*/
.ooOFO{height:100%;}/*!sc*/
data-styled.g2[id="elements__Column-sc-1wyezfv-1"]{content:"ooOFO,"}/*!sc*/
.hXBQku{margin:0 auto;max-width:1300px;}/*!sc*/
data-styled.g3[id="elements__CenterColumn-sc-1wyezfv-2"]{content:"hXBQku,"}/*!sc*/
.drfAlk{width:2em;height:.2em;background:#999;display:inline-block;position:relative;-webkit-transition:all .2s ease;transition:all .2s ease;}/*!sc*/
.drfAlk:before,.drfAlk:after{content:'';width:2em;height:.2em;background:#999;display:inline-block;position:absolute;}/*!sc*/
.drfAlk:before{top:.5em;-webkit-transform:none;-ms-transform:none;transform:none;}/*!sc*/
.drfAlk:after{top:-.5em;-webkit-transform:none;-ms-transform:none;transform:none;}/*!sc*/
data-styled.g4[id="bars__Bars-u5dep-0"]{content:"drfAlk,"}/*!sc*/
.loiSvS{width:100%;margin:0;padding:0;box-sizing:border-box;white-space:nowrap;font-size:10px;height:4em;}/*!sc*/
.loiSvS a{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.loiSvS ul{list-style:none;}/*!sc*/
@media screen and (max-width:576px){.loiSvS{display:none;}}/*!sc*/
data-styled.g7[id="Menu__MenuContainer-j5kisw-0"]{content:"loiSvS,"}/*!sc*/
.hBYYfK{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/*!sc*/
data-styled.g8[id="Menu-j5kisw-1"]{content:"hBYYfK,"}/*!sc*/
.fYonhq{display:block;position:absolute;z-index:999999;top:100%;left:0;background:#00818e;border-top:solid 3px #fff;border-left:none;visibility:hidden;opacity:0;-webkit-transition:all .6s ease;transition:all .6s ease;}/*!sc*/
.fYonhq:before{content:'';position:absolute;top:-1.3rem;left:1rem;border:solid .6rem transparent;border-bottom-color:#fff;border-right-color:transparent;}/*!sc*/
.RJFjY{display:block;position:absolute;z-index:999999;top:.3rem;left:100%;background:#00818e;border-top:none;border-left:solid 3px #fff;visibility:hidden;opacity:0;-webkit-transition:all .6s ease;transition:all .6s ease;}/*!sc*/
.RJFjY:before{content:'';position:absolute;top:.2rem;left:-1.3rem;border:solid .6rem transparent;border-bottom-color:transparent;border-right-color:#fff;}/*!sc*/
data-styled.g9[id="Menu__SubMenu-j5kisw-2"]{content:"fYonhq,RJFjY,"}/*!sc*/
.fduIiP{position:relative;line-height:4em;}/*!sc*/
.fduIiP a{display:block;padding:0 .5rem;font-size:1.1rem;color:#eee;-webkit-transition:color 0.6s;transition:color 0.6s;}/*!sc*/
.fduIiP a:hover{color:#fff;}/*!sc*/
.fduIiP:hover > .Menu__SubMenu-j5kisw-2{visibility:visible;opacity:1;}/*!sc*/
data-styled.g10[id="Menu__MenuItem-j5kisw-3"]{content:"fduIiP,"}/*!sc*/
.fPqVyF{line-height:2rem;}/*!sc*/
data-styled.g11[id="Menu__SubMenuItem-j5kisw-4"]{content:"fPqVyF,"}/*!sc*/
.khvRTO{position:relative;width:100vw;height:100vh;padding:6em 2em;line-height:3em;display:block;z-index:9999;font-size:24px;background:#00818e;-webkit-transform:translateX(110vw);-ms-transform:translateX(110vw);transform:translateX(110vw);-webkit-transition:all .6s ease;transition:all .6s ease;}/*!sc*/
data-styled.g12[id="MenuPop__Menu-sc-13h0v9c-0"]{content:"khvRTO,"}/*!sc*/
.jcGtGs{margin:0 0 0 1.2em;display:none;visibility:visible;opacity:1;}/*!sc*/
data-styled.g13[id="MenuPop__SubMenu-sc-13h0v9c-1"]{content:"jcGtGs,"}/*!sc*/
.ccsYZr{border-top:solid 1px #999;}/*!sc*/
.ccsYZr a{display:block;padding:0 .5em;font-size:1.1em;color:#999;-webkit-transition:color 0.6s;transition:color 0.6s;}/*!sc*/
.ccsYZr a:hover{color:#fff;}/*!sc*/
.ccsYZr:hover > .MenuPop__SubMenu-sc-13h0v9c-1{display:block;visibility:visible;opacity:1;}/*!sc*/
data-styled.g14[id="MenuPop__MenuItem-sc-13h0v9c-2"]{content:"ccsYZr,"}/*!sc*/
.dATEol{position:fixed;height:1px;font-size:10px;}/*!sc*/
.dATEol a{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.dATEol ul{list-style-type:none;}/*!sc*/
@media screen and (min-width:576px){.dATEol{display:none;}}/*!sc*/
data-styled.g15[id="MenuPop__MenuContainer-sc-13h0v9c-3"]{content:"dATEol,"}/*!sc*/
.iZiBKj{cursor:pointer;position:absolute;top:1em;right:2em;z-index:999999;}/*!sc*/
data-styled.g16[id="MenuPop__PopButton-sc-13h0v9c-4"]{content:"iZiBKj,"}/*!sc*/
.jkEQhy{max-width:1300px;min-height:6em;margin:0 auto;padding:1em;font-size:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}/*!sc*/
@media screen and (max-width:800px){.jkEQhy{line-height:2em;font-size:10px;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}}/*!sc*/
data-styled.g30[id="sectionfooter__FooterArea-sc-1k72v7z-0"]{content:"jkEQhy,"}/*!sc*/
.iqgeGh{max-width:1300px;margin:0 auto;padding:1em;font-family:"Courier New";font-size:16px;line-height:1.45em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}/*!sc*/
@media screen and (max-width:1300px){.iqgeGh{-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;font-size:10px;line-height:2.6em;}}/*!sc*/
data-styled.g40[id="blog__BlogContentArea-sc-16e624u-0"]{content:"iqgeGh,"}/*!sc*/
.cRLfuW{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;max-width:100%;padding:0 1em;min-height:100%;}/*!sc*/
.cRLfuW code{color:#111;background:#ddd;}/*!sc*/
.cRLfuW pre{margin:.5em 0;padding:.5em;overflow-x:scroll;background-color:#333;}/*!sc*/
.cRLfuW pre code{max-width:100%;font-family:Menlo,Monaco,"Courier New",monospace;color:#fff;background:transparent;font-size:.6em;}/*!sc*/
.cRLfuW a,.cRLfuW a:visited{color:#0000ff;}/*!sc*/
.cRLfuW a:hover,.cRLfuW a:focus,.cRLfuW a:active{color:#007cff;}/*!sc*/
.cRLfuW ul ul{padding:0 1.6em;}/*!sc*/
.cRLfuW ul ul ul{list-style-type:square;}/*!sc*/
.cRLfuW.retro-no-decoration{-webkit-text-decoration:none;text-decoration:none;}/*!sc*/
.cRLfuW p,.cRLfuW .retro-p{margin-bottom:.6em;}/*!sc*/
.cRLfuW h1,.cRLfuW .retro-h1,.cRLfuW h2,.cRLfuW .retro-h2,.cRLfuW h3,.cRLfuW .retro-h3,.cRLfuW h4,.cRLfuW .retro-h4{margin:1.414em 0 .5em;}/*!sc*/
.cRLfuW h1,.cRLfuW .retro-h1{width:100%;text-align:center;margin-top:0;font-size:1.8em;-webkit-letter-spacing:.16em;-moz-letter-spacing:.16em;-ms-letter-spacing:.16em;letter-spacing:.16em;}/*!sc*/
.cRLfuW h2,.cRLfuW .retro-h2{font-size:1.6em;}/*!sc*/
.cRLfuW h3,.cRLfuW .retro-h3{font-size:1.2em;}/*!sc*/
.cRLfuW h4,.cRLfuW .retro-h4{font-size:1em;}/*!sc*/
.cRLfuW h5,.cRLfuW .retro-h5{font-size:.8em;}/*!sc*/
.cRLfuW h6,.cRLfuW .retro-h6{font-size:.7em;}/*!sc*/
.cRLfuW small,.cRLfuW .retro-small{font-size:.6em;}/*!sc*/
.cRLfuW blockquote{margin:1em 0;padding-left:1em;border-left:.6em solid #00818e;}/*!sc*/
.cRLfuW img,.cRLfuW canvas,.cRLfuW iframe,.cRLfuW video,.cRLfuW svg,.cRLfuW select,.cRLfuW textarea{max-width:100%;}/*!sc*/
.cRLfuW table{border-collapse:collapse;border-spacing:0;empty-cells:show;border:1px solid #cbcbcb;}/*!sc*/
.cRLfuW thead{background-color:#666666;color:#fff;vertical-align:bottom;-webkit-letter-spacing:.2em;-moz-letter-spacing:.2em;-ms-letter-spacing:.2em;letter-spacing:.2em;}/*!sc*/
.cRLfuW td,.cRLfuW th{margin:0;padding:.5em 1em;border-left:1px solid #cbcbcb;border-width:0 0 0 1px;font-size:inherit;overflow:visible;}/*!sc*/
.cRLfuW tr:nth-child(2n+1){background-color:transparent;}/*!sc*/
.cRLfuW tr:nth-child(2n+0){background-color:#f9f9f9;}/*!sc*/
.cRLfuW caption{color:#000;font:italic 85%/1 arial,sans-serif;padding:1em 0;text-align:center;}/*!sc*/
data-styled.g41[id="blog__MarkdownContent-sc-16e624u-1"]{content:"cRLfuW,"}/*!sc*/
.eMQCOq{padding:0 1em;}/*!sc*/
@media screen and (max-width:1024px){.eMQCOq{padding:2em 1em;}}/*!sc*/
data-styled.g42[id="blog__SideColumn-sc-16e624u-2"]{content:"eMQCOq,"}/*!sc*/
.gnOjhs{margin-left:1em;color:#999;-webkit-text-decoration:underline;text-decoration:underline;}/*!sc*/
data-styled.g43[id="blog__Tag-sc-16e624u-3"]{content:"gnOjhs,"}/*!sc*/
.dZNJvK{width:100%;margin-top:.2em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}/*!sc*/
.dZNJvK span{font-weight:bold;-webkit-letter-spacing:.16em;-moz-letter-spacing:.16em;-ms-letter-spacing:.16em;letter-spacing:.16em;}/*!sc*/
data-styled.g44[id="blog__TagsList-sc-16e624u-4"]{content:"dZNJvK,"}/*!sc*/
.ehtuIq{width:100%;}/*!sc*/
.ehtuIq h5,.ehtuIq h6,.ehtuIq p{display:inline-block;line-height:2em;font-size:.8em;}/*!sc*/
.ehtuIq h5{color:#00b8cb;}/*!sc*/
.ehtuIq h6{font-weight:normal;}/*!sc*/
data-styled.g45[id="blog__Details-sc-16e624u-5"]{content:"ehtuIq,"}/*!sc*/
</style><title data-react-helmet="true">WeReady | é€šè¿‡ frp å®ç°å†…ç½‘ç©¿é€</title><meta data-react-helmet="true" name="keywords" content="å†…ç½‘ç©¿é€"/><meta data-react-helmet="true" property="wr:type" content="æŒ‡å¯¼æ‰‹å†Œ"/><meta data-react-helmet="true" property="wr:title" content="é€šè¿‡ frp å®ç°å†…ç½‘ç©¿é€"/><meta data-react-helmet="true" property="wr:description" content="å¼€å‘æŸäº›å¾®ä¿¡ã€æ·˜å®åŠŸèƒ½æ—¶ï¼Œç¬¬ä¸‰æ–¹æœåŠ¡å™¨éœ€è¦è®¿é—®å…¬ç½‘IPï¼Œå› æ­¤ï¼Œæœ¬åœ°çš„å¼€å‘ç¯å¢ƒï¼Œä¹Ÿéœ€è¦å…·å¤‡æš´éœ²åœ¨å…¬ç½‘çš„èƒ½åŠ›ã€‚"/><link as="script" rel="preload" href="/webpack-runtime-c07136e716a8635769c9.js"/><link as="script" rel="preload" href="/framework-8e528b732ab2eaadb7b7.js"/><link as="script" rel="preload" href="/app-bc5e397393304c21210d.js"/><link as="script" rel="preload" href="/styles-407fe62976dc5310c43e.js"/><link as="script" rel="preload" href="/a7ed190188128b6222399f6e5792102bea54436b-211e04e450f51c8f64da.js"/><link as="script" rel="preload" href="/component---src-templates-blog-js-74b8cafac62daa61107d.js"/><link as="fetch" rel="preload" href="/page-data/blog/20210130002_frp/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2718502863.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3159585216.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/847266990.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div id="__page_top__"></div><div style="position:fixed;bottom:2rem;right:2rem;z-index:99999;font-size:2rem"><a href="#__page_top__"><span role="img" aria-label="Up">ğŸ‘</span></a></div><div style="background:linear-gradient(90deg,#00818e,#00b8cb)" class="elements__Section-sc-1wyezfv-0 cwuJxU"><div class="elements__Column-sc-1wyezfv-1 elements__CenterColumn-sc-1wyezfv-2 ooOFO hXBQku"><div class="MenuPop__MenuContainer-sc-13h0v9c-3 dATEol container" color="[object Object]"><div class="MenuPop__PopButton-sc-13h0v9c-4 iZiBKj button"><span color="#999" class="bars__Bars-u5dep-0 drfAlk"></span></div><ul class="MenuPop__Menu-sc-13h0v9c-0 khvRTO menu" color="[object Object]"><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/"><span>é¦–é¡µ</span></a></li><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/#"><span>æ¼”ç¤º</span><div style="height:100%;margin-left:.3em;display:inline-flex;justify-content:center;align-items:center"><svg xmlns="http://www.w3.org/2000/svg" width=".8em" height=".8em" viewBox="0 0 16 16"><polygon points="2,4 14,4 9,13" style="fill:#999"></polygon></svg></div></a><ul class="MenuPop__SubMenu-sc-13h0v9c-1 jcGtGs menu" color="[object Object]"><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/storybook.html"><span>ç»„ä»¶</span></a></li><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/#"><span>é¦–é¡µ</span><div style="height:100%;margin-left:.3em;display:inline-flex;justify-content:center;align-items:center"><svg xmlns="http://www.w3.org/2000/svg" width=".8em" height=".8em" viewBox="0 0 16 16"><polygon points="2,4 14,4 9,13" style="fill:#999"></polygon></svg></div></a><ul class="MenuPop__SubMenu-sc-13h0v9c-1 jcGtGs menu" color="[object Object]"><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/pepsi"><span>ç™¾äº‹å¯ä¹</span></a></li></ul></li></ul></li><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/service"><span>æœåŠ¡</span></a></li><li color="[object Object]" class="MenuPop__MenuItem-sc-13h0v9c-2 ccsYZr"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/member"><span>ä¼šå‘˜</span></a></li></ul></div><div style="width:100%;display:flex;justify-content:center"><div style="width:20rem;color:#fff"><nav color="[object Object]" class="Menu__MenuContainer-j5kisw-0 loiSvS"><ul class="Menu-j5kisw-1 hBYYfK"><li color="[object Object]" class="Menu__MenuItem-j5kisw-3 fduIiP"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/"><span>é¦–é¡µ</span></a></li><li color="[object Object]" class="Menu__MenuItem-j5kisw-3 fduIiP"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/#"><span>æ¼”ç¤º</span><div style="height:100%;margin-left:.3em;display:inline-flex;justify-content:center;align-items:center"><svg xmlns="http://www.w3.org/2000/svg" width=".8em" height=".8em" viewBox="0 0 16 16"><polygon points="2,4 14,4 9,13"></polygon></svg></div></a><ul color="[object Object]" class="Menu__SubMenu-j5kisw-2 fYonhq"><li class="Menu__MenuItem-j5kisw-3 Menu__SubMenuItem-j5kisw-4 fduIiP fPqVyF"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/storybook.html"><span>ç»„ä»¶</span></a></li><li class="Menu__MenuItem-j5kisw-3 Menu__SubMenuItem-j5kisw-4 fduIiP fPqVyF"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/#"><span>é¦–é¡µ</span><div style="height:100%;margin-left:.3em;display:inline-flex;justify-content:center;align-items:center"><svg xmlns="http://www.w3.org/2000/svg" width=".8em" height=".8em" viewBox="0 0 16 16"><polygon points="4,3 13,9 4,14"></polygon></svg></div></a><ul color="[object Object]" class="Menu__SubMenu-j5kisw-2 RJFjY"><li class="Menu__MenuItem-j5kisw-3 Menu__SubMenuItem-j5kisw-4 fduIiP fPqVyF"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/pepsi"><span>ç™¾äº‹å¯ä¹</span></a></li></ul></li></ul></li><li color="[object Object]" class="Menu__MenuItem-j5kisw-3 fduIiP"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/service"><span>æœåŠ¡</span></a></li><li color="[object Object]" class="Menu__MenuItem-j5kisw-3 fduIiP"><a style="width:100%;display:flex;justify-content:space-between;align-items:center" href="/member"><span>ä¼šå‘˜</span></a></li></ul></nav></div></div></div></div><div style="background:#fff;padding:1em" class="elements__Section-sc-1wyezfv-0 cwuJxU"><div class="blog__BlogContentArea-sc-16e624u-0 iqgeGh"><div class="blog__MarkdownContent-sc-16e624u-1 cRLfuW"><h1>é€šè¿‡ frp å®ç°å†…ç½‘ç©¿é€</h1>
<h2>Install Server Side Service</h2>
<pre><code>wget https://github.com/fatedier/frp/releases/download/v0.32.0/frp_0.32.0_linux_amd64.tar.gz
</code></pre>
<pre><code>tar -zxvf frp_0.32.0_linux_amd64.tar.gz
</code></pre>
<pre><code>cd frp_0.32.0_linux_amd64
cp frps.ini frps.bak
vi frps.ini
</code></pre>
<pre><code># frps.ini
[common]
bind_port = 7000
vhost_http_port = 80
</code></pre>
<pre><code>vi start.sh
</code></pre>
<pre><code>#!/bin/bash
# start frp service

./frps -c ./frps.ini
</code></pre>
<h2>Start frp Service</h2>
<pre><code>sh start.sh
</code></pre>
<h2>Install Client Side Application</h2>
<ul>
<li>download <code>https://github.com/fatedier/frp/releases/download/v0.32.0/frp_0.32.0_windows_amd64.zip</code></li>
<li>unzip</li>
<li>backup frpc.ini ==>> frpc.bak</li>
</ul>
<h2>Config</h2>
<pre><code># frpc.ini
[common]
server_addr = x.x.x.x                   # server IP
server_port = 7000

[web]
type = http
local_port = 3000
custom_domains = www.yourdomain.com     # domain
</code></pre>
<h2>Start Client</h2>
<blockquote>
<p>save as bat file</p>
</blockquote>
<pre><code>frpc -c frpc.ini
</code></pre>
<h2>---------------- åˆ†å‰²çº¿ ä»¥ä¸‹æ˜¯ 2020-03-17 æ—¶çš„å¿«ç…§ ------------------------------------</h2>
<p>å†…å®¹æ¥è‡ª <a href="https://github.com/fatedier/frp">frp</a> çš„ <a href="https://github.com/fatedier/frp/blob/master/README_zh.md">readme</a> æ–‡æ¡£ã€‚</p>
<h2>frp</h2>
<p><a href="https://travis-ci.org/fatedier/frp"><img src="https://travis-ci.org/fatedier/frp.svg?branch=master" alt="Build Status"></a></p>
<p><a href="README.md">README</a> | <a href="README_zh.md">ä¸­æ–‡æ–‡æ¡£</a></p>
<p>frp æ˜¯ä¸€ä¸ªå¯ç”¨äºå†…ç½‘ç©¿é€çš„é«˜æ€§èƒ½çš„åå‘ä»£ç†åº”ç”¨ï¼Œæ”¯æŒ tcp, udp åè®®ï¼Œä¸º http å’Œ https åº”ç”¨åè®®æä¾›äº†é¢å¤–çš„èƒ½åŠ›ï¼Œä¸”å°è¯•æ€§æ”¯æŒäº†ç‚¹å¯¹ç‚¹ç©¿é€ã€‚</p>
<h3>ç›®å½•</h3>
<!-- vim-markdown-toc GFM -->
<ul>
<li><a href="#%E5%BC%80%E5%8F%91%E7%8A%B6%E6%80%81">å¼€å‘çŠ¶æ€</a></li>
<li><a href="#%E6%9E%B6%E6%9E%84">æ¶æ„</a></li>
<li>
<p><a href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">ä½¿ç”¨ç¤ºä¾‹</a></p>
<ul>
<li><a href="#%E9%80%9A%E8%BF%87-ssh-%E8%AE%BF%E9%97%AE%E5%85%AC%E5%8F%B8%E5%86%85%E7%BD%91%E6%9C%BA%E5%99%A8">é€šè¿‡ ssh è®¿é—®å…¬å¸å†…ç½‘æœºå™¨</a></li>
<li><a href="#%E9%80%9A%E8%BF%87%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9F%9F%E5%90%8D%E8%AE%BF%E9%97%AE%E9%83%A8%E7%BD%B2%E4%BA%8E%E5%86%85%E7%BD%91%E7%9A%84-web-%E6%9C%8D%E5%8A%A1">é€šè¿‡è‡ªå®šä¹‰åŸŸåè®¿é—®éƒ¨ç½²äºå†…ç½‘çš„ web æœåŠ¡</a></li>
<li><a href="#%E8%BD%AC%E5%8F%91-dns-%E6%9F%A5%E8%AF%A2%E8%AF%B7%E6%B1%82">è½¬å‘ DNS æŸ¥è¯¢è¯·æ±‚</a></li>
<li><a href="#%E8%BD%AC%E5%8F%91-unix-%E5%9F%9F%E5%A5%97%E6%8E%A5%E5%AD%97">è½¬å‘ Unix åŸŸå¥—æ¥å­—</a></li>
<li><a href="#%E5%AF%B9%E5%A4%96%E6%8F%90%E4%BE%9B%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%E6%9C%8D%E5%8A%A1">å¯¹å¤–æä¾›ç®€å•çš„æ–‡ä»¶è®¿é—®æœåŠ¡</a></li>
<li><a href="#%E4%B8%BA%E6%9C%AC%E5%9C%B0-http-%E6%9C%8D%E5%8A%A1%E5%90%AF%E7%94%A8-https">ä¸ºæœ¬åœ° HTTP æœåŠ¡å¯ç”¨ HTTPS</a></li>
<li><a href="#%E5%AE%89%E5%85%A8%E5%9C%B0%E6%9A%B4%E9%9C%B2%E5%86%85%E7%BD%91%E6%9C%8D%E5%8A%A1">å®‰å…¨åœ°æš´éœ²å†…ç½‘æœåŠ¡</a></li>
<li><a href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F">ç‚¹å¯¹ç‚¹å†…ç½‘ç©¿é€</a></li>
</ul>
</li>
<li>
<p><a href="#%E5%8A%9F%E8%83%BD%E8%AF%B4%E6%98%8E">åŠŸèƒ½è¯´æ˜</a></p>
<ul>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">é…ç½®æ–‡ä»¶</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A8%A1%E7%89%88%E6%B8%B2%E6%9F%93">é…ç½®æ–‡ä»¶æ¨¡ç‰ˆæ¸²æŸ“</a></li>
<li><a href="#dashboard">Dashboard</a></li>
<li><a href="#admin-ui">Admin UI</a></li>
<li>
<p><a href="#%E7%9B%91%E6%8E%A7">ç›‘æ§</a></p>
<ul>
<li><a href="#prometheus">Prometheus</a></li>
</ul>
</li>
<li>
<p><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81">å®¢æˆ·ç«¯èº«ä»½éªŒè¯</a></p>
<ul>
<li><a href="#token">Token</a></li>
<li><a href="#oidc">OIDC</a></li>
</ul>
</li>
<li>
<p><a href="#%E5%8A%A0%E5%AF%86%E4%B8%8E%E5%8E%8B%E7%BC%A9">åŠ å¯†ä¸å‹ç¼©</a></p>
<ul>
<li><a href="#tls">TLS</a></li>
</ul>
</li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%83%AD%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">å®¢æˆ·ç«¯çƒ­åŠ è½½é…ç½®æ–‡ä»¶</a></li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%9F%A5%E7%9C%8B%E4%BB%A3%E7%90%86%E7%8A%B6%E6%80%81">å®¢æˆ·ç«¯æŸ¥çœ‹ä»£ç†çŠ¶æ€</a></li>
<li><a href="#%E7%AB%AF%E5%8F%A3%E7%99%BD%E5%90%8D%E5%8D%95">ç«¯å£ç™½åå•</a></li>
<li><a href="#%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8">ç«¯å£å¤ç”¨</a></li>
<li>
<p><a href="#%E9%99%90%E9%80%9F">é™é€Ÿ</a></p>
<ul>
<li><a href="#%E4%BB%A3%E7%90%86%E9%99%90%E9%80%9F">ä»£ç†é™é€Ÿ</a></li>
</ul>
</li>
<li><a href="#tcp-%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8">TCP å¤šè·¯å¤ç”¨</a></li>
<li><a href="#%E5%BA%95%E5%B1%82%E9%80%9A%E4%BF%A1%E5%8F%AF%E9%80%89-kcp-%E5%8D%8F%E8%AE%AE">åº•å±‚é€šä¿¡å¯é€‰ kcp åè®®</a></li>
<li><a href="#%E8%BF%9E%E6%8E%A5%E6%B1%A0">è¿æ¥æ± </a></li>
<li><a href="#%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1">è´Ÿè½½å‡è¡¡</a></li>
<li><a href="#%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5">å¥åº·æ£€æŸ¥</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9-host-header">ä¿®æ”¹ Host Header</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE-http-%E8%AF%B7%E6%B1%82%E7%9A%84-header">è®¾ç½® HTTP è¯·æ±‚çš„ header</a></li>
<li>
<p><a href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E7%9C%9F%E5%AE%9E-ip">è·å–ç”¨æˆ·çœŸå® IP</a></p>
<ul>
<li><a href="#http-x-forwarded-for">HTTP X-Forwarded-For</a></li>
<li><a href="#proxy-protocol">Proxy Protocol</a></li>
</ul>
</li>
<li><a href="#%E9%80%9A%E8%BF%87%E5%AF%86%E7%A0%81%E4%BF%9D%E6%8A%A4%E4%BD%A0%E7%9A%84-web-%E6%9C%8D%E5%8A%A1">é€šè¿‡å¯†ç ä¿æŠ¤ä½ çš„ web æœåŠ¡</a></li>
<li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8C%E7%BA%A7%E5%9F%9F%E5%90%8D">è‡ªå®šä¹‰äºŒçº§åŸŸå</a></li>
<li><a href="#url-%E8%B7%AF%E7%94%B1">URL è·¯ç”±</a></li>
<li><a href="#tcp-%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8%E7%B1%BB%E5%9E%8B">TCP ç«¯å£å¤ç”¨ç±»å‹</a></li>
<li><a href="#%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%BF%9E%E6%8E%A5-frps">é€šè¿‡ä»£ç†è¿æ¥ frps</a></li>
<li><a href="#%E8%8C%83%E5%9B%B4%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84">èŒƒå›´ç«¯å£æ˜ å°„</a></li>
<li><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8F%92%E4%BB%B6">å®¢æˆ·ç«¯æ’ä»¶</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%AE%A1%E7%90%86%E6%8F%92%E4%BB%B6">æœåŠ¡ç«¯ç®¡ç†æ’ä»¶</a></li>
</ul>
</li>
<li><a href="#%E5%BC%80%E5%8F%91%E8%AE%A1%E5%88%92">å¼€å‘è®¡åˆ’</a></li>
<li><a href="#%E4%B8%BA-frp-%E5%81%9A%E8%B4%A1%E7%8C%AE">ä¸º frp åšè´¡çŒ®</a></li>
<li>
<p><a href="#%E6%8D%90%E5%8A%A9">æåŠ©</a></p>
<ul>
<li><a href="#%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83">çŸ¥è¯†æ˜Ÿçƒ</a></li>
<li><a href="#%E6%94%AF%E4%BB%98%E5%AE%9D%E6%89%AB%E7%A0%81%E6%8D%90%E8%B5%A0">æ”¯ä»˜å®æ‰«ç æèµ </a></li>
<li><a href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E6%8D%90%E8%B5%A0">å¾®ä¿¡æ”¯ä»˜æèµ </a></li>
<li><a href="#paypal-%E6%8D%90%E8%B5%A0">Paypal æèµ </a></li>
</ul>
</li>
</ul>
<!-- vim-markdown-toc -->
<h3>å¼€å‘çŠ¶æ€</h3>
<p>frp ä»ç„¶å¤„äºå¼€å‘é˜¶æ®µï¼Œæœªç»å……åˆ†æµ‹è¯•ä¸éªŒè¯ï¼Œä¸æ¨èç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p>
<p>master åˆ†æ”¯ç”¨äºå‘å¸ƒç¨³å®šç‰ˆæœ¬ï¼Œdev åˆ†æ”¯ç”¨äºå¼€å‘ï¼Œæ‚¨å¯ä»¥å°è¯•ä¸‹è½½æœ€æ–°çš„ release ç‰ˆæœ¬è¿›è¡Œæµ‹è¯•ã€‚</p>
<p><strong>ç›®å‰çš„äº¤äº’åè®®å¯èƒ½éšæ—¶æ”¹å˜ï¼Œä¸ä¿è¯å‘åå…¼å®¹ï¼Œå‡çº§æ–°ç‰ˆæœ¬æ—¶éœ€è¦æ³¨æ„å…¬å‘Šè¯´æ˜åŒæ—¶å‡çº§æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</strong></p>
<h3>æ¶æ„</h3>
<p><img src="/doc/pic/architecture.png" alt="architecture"></p>
<h3>ä½¿ç”¨ç¤ºä¾‹</h3>
<p>æ ¹æ®å¯¹åº”çš„æ“ä½œç³»ç»ŸåŠæ¶æ„ï¼Œä» <a href="https://github.com/fatedier/frp/releases">Release</a> é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ç¨‹åºã€‚</p>
<p>å°† <strong>frps</strong> åŠ <strong>frps.ini</strong> æ”¾åˆ°å…·æœ‰å…¬ç½‘ IP çš„æœºå™¨ä¸Šã€‚</p>
<p>å°† <strong>frpc</strong> åŠ <strong>frpc.ini</strong> æ”¾åˆ°å¤„äºå†…ç½‘ç¯å¢ƒçš„æœºå™¨ä¸Šã€‚</p>
<h4>é€šè¿‡ ssh è®¿é—®å…¬å¸å†…ç½‘æœºå™¨</h4>
<ol>
<li>ä¿®æ”¹ frps.ini æ–‡ä»¶ï¼Œè¿™é‡Œä½¿ç”¨äº†æœ€ç®€åŒ–çš„é…ç½®ï¼š</li>
</ol>
<pre><code class="language-ini"># frps.ini
[common]
bind_port = 7000
</code></pre>
<ol start="2">
<li>å¯åŠ¨ frpsï¼š</li>
</ol>
<p>  <code>./frps -c ./frps.ini</code></p>
<ol start="3">
<li>ä¿®æ”¹ frpc.ini æ–‡ä»¶ï¼Œå‡è®¾ frps æ‰€åœ¨æœåŠ¡å™¨çš„å…¬ç½‘ IP ä¸º x.x.x.xï¼›</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = 6000
</code></pre>
<ol start="4">
<li>å¯åŠ¨ frpcï¼š</li>
</ol>
<p>  <code>./frpc -c ./frpc.ini</code></p>
<ol start="5">
<li>é€šè¿‡ ssh è®¿é—®å†…ç½‘æœºå™¨ï¼Œå‡è®¾ç”¨æˆ·åä¸º testï¼š</li>
</ol>
<p>  <code>ssh -oPort=6000 test@x.x.x.x</code></p>
<h4>é€šè¿‡è‡ªå®šä¹‰åŸŸåè®¿é—®éƒ¨ç½²äºå†…ç½‘çš„ web æœåŠ¡</h4>
<p>æœ‰æ—¶æƒ³è¦è®©å…¶ä»–äººé€šè¿‡åŸŸåè®¿é—®æˆ–è€…æµ‹è¯•æˆ‘ä»¬åœ¨æœ¬åœ°æ­å»ºçš„ web æœåŠ¡ï¼Œä½†æ˜¯ç”±äºæœ¬åœ°æœºå™¨æ²¡æœ‰å…¬ç½‘ IPï¼Œæ— æ³•å°†åŸŸåè§£æåˆ°æœ¬åœ°çš„æœºå™¨ï¼Œé€šè¿‡ frp å°±å¯ä»¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œä»¥ä¸‹ç¤ºä¾‹ä¸º http æœåŠ¡ï¼Œhttps æœåŠ¡é…ç½®æ–¹æ³•ç›¸åŒï¼Œ vhost<em>http</em>port æ›¿æ¢ä¸º vhost<em>https</em>portï¼Œ type è®¾ç½®ä¸º https å³å¯ã€‚</p>
<ol>
<li>ä¿®æ”¹ frps.ini æ–‡ä»¶ï¼Œè®¾ç½® http è®¿é—®ç«¯å£ä¸º 8080ï¼š</li>
</ol>
<pre><code class="language-ini"># frps.ini
[common]
bind_port = 7000
vhost_http_port = 8080
</code></pre>
<ol start="2">
<li>å¯åŠ¨ frpsï¼š</li>
</ol>
<p>  <code>./frps -c ./frps.ini</code></p>
<ol start="3">
<li>ä¿®æ”¹ frpc.ini æ–‡ä»¶ï¼Œå‡è®¾ frps æ‰€åœ¨çš„æœåŠ¡å™¨çš„ IP ä¸º x.x.x.xï¼Œlocal_port ä¸ºæœ¬åœ°æœºå™¨ä¸Š web æœåŠ¡å¯¹åº”çš„ç«¯å£, ç»‘å®šè‡ªå®šä¹‰åŸŸå <code>www.yourdomain.com</code>:</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[web]
type = http
local_port = 80
custom_domains = www.yourdomain.com
</code></pre>
<ol start="4">
<li>å¯åŠ¨ frpcï¼š</li>
</ol>
<p>  <code>./frpc -c ./frpc.ini</code></p>
<ol start="5">
<li>å°† <code>www.yourdomain.com</code> çš„åŸŸå A è®°å½•è§£æåˆ° IP <code>x.x.x.x</code>ï¼Œå¦‚æœæœåŠ¡å™¨å·²ç»æœ‰å¯¹åº”çš„åŸŸåï¼Œä¹Ÿå¯ä»¥å°† CNAME è®°å½•è§£æåˆ°æœåŠ¡å™¨åŸå…ˆçš„åŸŸåã€‚</li>
<li>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>http://www.yourdomain.com:8080</code> å³å¯è®¿é—®åˆ°å¤„äºå†…ç½‘æœºå™¨ä¸Šçš„ web æœåŠ¡ã€‚</li>
</ol>
<h4>è½¬å‘ DNS æŸ¥è¯¢è¯·æ±‚</h4>
<p>DNS æŸ¥è¯¢è¯·æ±‚é€šå¸¸ä½¿ç”¨ UDP åè®®ï¼Œfrp æ”¯æŒå¯¹å†…ç½‘ UDP æœåŠ¡çš„ç©¿é€ï¼Œé…ç½®æ–¹å¼å’Œ TCP åŸºæœ¬ä¸€è‡´ã€‚</p>
<ol>
<li>ä¿®æ”¹ frps.ini æ–‡ä»¶ï¼š</li>
</ol>
<pre><code class="language-ini"># frps.ini
[common]
bind_port = 7000
</code></pre>
<ol start="2">
<li>å¯åŠ¨ frpsï¼š</li>
</ol>
<p>  <code>./frps -c ./frps.ini</code></p>
<ol start="3">
<li>ä¿®æ”¹ frpc.ini æ–‡ä»¶ï¼Œè®¾ç½® frps æ‰€åœ¨æœåŠ¡å™¨çš„ IP ä¸º x.x.x.xï¼Œè½¬å‘åˆ° Google çš„ DNS æŸ¥è¯¢æœåŠ¡å™¨ <code>8.8.8.8</code> çš„ udp 53 ç«¯å£ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[dns]
type = udp
local_ip = 8.8.8.8
local_port = 53
remote_port = 6000
</code></pre>
<ol start="4">
<li>å¯åŠ¨ frpcï¼š</li>
</ol>
<p>  <code>./frpc -c ./frpc.ini</code></p>
<ol start="5">
<li>é€šè¿‡ dig æµ‹è¯• UDP åŒ…è½¬å‘æ˜¯å¦æˆåŠŸï¼Œé¢„æœŸä¼šè¿”å› <code>www.google.com</code> åŸŸåçš„è§£æç»“æœï¼š</li>
</ol>
<p>  <code>dig @x.x.x.x -p 6000 www.google.com</code></p>
<h4>è½¬å‘ Unix åŸŸå¥—æ¥å­—</h4>
<p>é€šè¿‡ tcp ç«¯å£è®¿é—®å†…ç½‘çš„ unixåŸŸå¥—æ¥å­—(ä¾‹å¦‚å’Œ docker daemon é€šä¿¡)ã€‚</p>
<p>frps çš„éƒ¨ç½²æ­¥éª¤åŒä¸Šã€‚</p>
<ol>
<li>å¯åŠ¨ frpcï¼Œå¯ç”¨ <code>unix_domain_socket</code> æ’ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[unix_domain_socket]
type = tcp
remote_port = 6000
plugin = unix_domain_socket
plugin_unix_path = /var/run/docker.sock
</code></pre>
<ol start="2">
<li>é€šè¿‡ curl å‘½ä»¤æŸ¥çœ‹ docker ç‰ˆæœ¬ä¿¡æ¯</li>
</ol>
<p>  <code>curl http://x.x.x.x:6000/version</code></p>
<h4>å¯¹å¤–æä¾›ç®€å•çš„æ–‡ä»¶è®¿é—®æœåŠ¡</h4>
<p>é€šè¿‡ <code>static_file</code> æ’ä»¶å¯ä»¥å¯¹å¤–æä¾›ä¸€ä¸ªç®€å•çš„åŸºäº HTTP çš„æ–‡ä»¶è®¿é—®æœåŠ¡ã€‚</p>
<p>frps çš„éƒ¨ç½²æ­¥éª¤åŒä¸Šã€‚</p>
<ol>
<li>å¯åŠ¨ frpcï¼Œå¯ç”¨ <code>static_file</code> æ’ä»¶ï¼Œé…ç½®å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[test_static_file]
type = tcp
remote_port = 6000
plugin = static_file
# è¦å¯¹å¤–æš´éœ²çš„æ–‡ä»¶ç›®å½•
plugin_local_path = /tmp/file
# è®¿é—® url ä¸­ä¼šè¢«å»é™¤çš„å‰ç¼€ï¼Œä¿ç•™çš„å†…å®¹å³ä¸ºè¦è®¿é—®çš„æ–‡ä»¶è·¯å¾„
plugin_strip_prefix = static
plugin_http_user = abc
plugin_http_passwd = abc
</code></pre>
<ol start="2">
<li>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>http://x.x.x.x:6000/static/</code> æ¥æŸ¥çœ‹ä½äº <code>/tmp/file</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œä¼šè¦æ±‚è¾“å…¥å·²è®¾ç½®å¥½çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</li>
</ol>
<h4>ä¸ºæœ¬åœ° HTTP æœåŠ¡å¯ç”¨ HTTPS</h4>
<p>é€šè¿‡ <code>https2http</code> æ’ä»¶å¯ä»¥è®©æœ¬åœ° HTTP æœåŠ¡è½¬æ¢æˆ HTTPS æœåŠ¡å¯¹å¤–æä¾›ã€‚</p>
<ol>
<li>å¯ç”¨ frpcï¼Œå¯ç”¨ <code>https2http</code> æ’ä»¶ï¼Œé…ç½®å¦‚ä¸‹:</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[test_htts2http]
type = https
custom_domains = test.yourdomain.com

plugin = https2http
plugin_local_addr = 127.0.0.1:80

# HTTPS è¯ä¹¦ç›¸å…³çš„é…ç½®
plugin_crt_path = ./server.crt
plugin_key_path = ./server.key
plugin_host_header_rewrite = 127.0.0.1
plugin_header_X-From-Where = frp
</code></pre>
<ol start="2">
<li>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>https://test.yourdomain.com</code> å³å¯ã€‚</li>
</ol>
<h4>å®‰å…¨åœ°æš´éœ²å†…ç½‘æœåŠ¡</h4>
<p>å¯¹äºæŸäº›æœåŠ¡æ¥è¯´å¦‚æœç›´æ¥æš´éœ²äºå…¬ç½‘ä¸Šå°†ä¼šå­˜åœ¨å®‰å…¨éšæ‚£ã€‚</p>
<p>ä½¿ç”¨ <strong>stcp(secret tcp)</strong> ç±»å‹çš„ä»£ç†å¯ä»¥é¿å…è®©ä»»ä½•äººéƒ½èƒ½è®¿é—®åˆ°è¦ç©¿é€çš„æœåŠ¡ï¼Œä½†æ˜¯è®¿é—®è€…ä¹Ÿéœ€è¦è¿è¡Œå¦å¤–ä¸€ä¸ª frpcã€‚</p>
<p>ä»¥ä¸‹ç¤ºä¾‹å°†ä¼šåˆ›å»ºä¸€ä¸ªåªæœ‰è‡ªå·±èƒ½è®¿é—®åˆ°çš„ ssh æœåŠ¡ä»£ç†ã€‚</p>
<p>frps çš„éƒ¨ç½²æ­¥éª¤åŒä¸Šã€‚</p>
<ol>
<li>å¯åŠ¨ frpcï¼Œè½¬å‘å†…ç½‘çš„ ssh æœåŠ¡ï¼Œé…ç½®å¦‚ä¸‹ï¼Œä¸éœ€è¦æŒ‡å®šè¿œç¨‹ç«¯å£ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[secret_ssh]
type = stcp
# åªæœ‰ sk ä¸€è‡´çš„ç”¨æˆ·æ‰èƒ½è®¿é—®åˆ°æ­¤æœåŠ¡
sk = abcdefg
local_ip = 127.0.0.1
local_port = 22
</code></pre>
<ol start="2">
<li>åœ¨è¦è®¿é—®è¿™ä¸ªæœåŠ¡çš„æœºå™¨ä¸Šå¯åŠ¨å¦å¤–ä¸€ä¸ª frpcï¼Œé…ç½®å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[secret_ssh_visitor]
type = stcp
# stcp çš„è®¿é—®è€…
role = visitor
# è¦è®¿é—®çš„ stcp ä»£ç†çš„åå­—
server_name = secret_ssh
sk = abcdefg
# ç»‘å®šæœ¬åœ°ç«¯å£ç”¨äºè®¿é—® ssh æœåŠ¡
bind_addr = 127.0.0.1
bind_port = 6000
</code></pre>
<ol start="3">
<li>é€šè¿‡ ssh è®¿é—®å†…ç½‘æœºå™¨ï¼Œå‡è®¾ç”¨æˆ·åä¸º testï¼š</li>
</ol>
<p>  <code>ssh -oPort=6000 test@127.0.0.1</code></p>
<h4>ç‚¹å¯¹ç‚¹å†…ç½‘ç©¿é€</h4>
<p>frp æä¾›äº†ä¸€ç§æ–°çš„ä»£ç†ç±»å‹ <strong>xtcp</strong> ç”¨äºåº”å¯¹åœ¨å¸Œæœ›ä¼ è¾“å¤§é‡æ•°æ®ä¸”æµé‡ä¸ç»è¿‡æœåŠ¡å™¨çš„åœºæ™¯ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼åŒ <strong>stcp</strong> ç±»ä¼¼ï¼Œéœ€è¦åœ¨ä¸¤è¾¹éƒ½éƒ¨ç½²ä¸Š frpc ç”¨äºå»ºç«‹ç›´æ¥çš„è¿æ¥ã€‚</p>
<p>ç›®å‰å¤„äºå¼€å‘çš„åˆçº§é˜¶æ®µï¼Œå¹¶ä¸èƒ½ç©¿é€æ‰€æœ‰ç±»å‹çš„ NAT è®¾å¤‡ï¼Œæ‰€ä»¥ç©¿é€æˆåŠŸç‡è¾ƒä½ã€‚ç©¿é€å¤±è´¥æ—¶å¯ä»¥å°è¯• <strong>stcp</strong> çš„æ–¹å¼ã€‚</p>
<ol>
<li>frps é™¤æ­£å¸¸é…ç½®å¤–éœ€è¦é¢å¤–é…ç½®ä¸€ä¸ª udp ç«¯å£ç”¨äºæ”¯æŒè¯¥ç±»å‹çš„å®¢æˆ·ç«¯:</li>
</ol>
<pre><code class="language-ini">bind_udp_port = 7001
</code></pre>
<ol start="2">
<li>å¯åŠ¨ frpcï¼Œè½¬å‘å†…ç½‘çš„ ssh æœåŠ¡ï¼Œé…ç½®å¦‚ä¸‹ï¼Œä¸éœ€è¦æŒ‡å®šè¿œç¨‹ç«¯å£:</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[p2p_ssh]
type = xtcp
# åªæœ‰ sk ä¸€è‡´çš„ç”¨æˆ·æ‰èƒ½è®¿é—®åˆ°æ­¤æœåŠ¡
sk = abcdefg
local_ip = 127.0.0.1
local_port = 22
</code></pre>
<ol start="3">
<li>åœ¨è¦è®¿é—®è¿™ä¸ªæœåŠ¡çš„æœºå™¨ä¸Šå¯åŠ¨å¦å¤–ä¸€ä¸ª frpcï¼Œé…ç½®å¦‚ä¸‹:</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[p2p_ssh_visitor]
type = xtcp
# xtcp çš„è®¿é—®è€…
role = visitor
# è¦è®¿é—®çš„ xtcp ä»£ç†çš„åå­—
server_name = p2p_ssh
sk = abcdefg
# ç»‘å®šæœ¬åœ°ç«¯å£ç”¨äºè®¿é—® ssh æœåŠ¡
bind_addr = 127.0.0.1
bind_port = 6000
</code></pre>
<ol start="4">
<li>é€šè¿‡ ssh è®¿é—®å†…ç½‘æœºå™¨ï¼Œå‡è®¾ç”¨æˆ·åä¸º test:</li>
</ol>
<p>  <code>ssh -oPort=6000 test@127.0.0.1</code></p>
<h3>åŠŸèƒ½è¯´æ˜</h3>
<h4>é…ç½®æ–‡ä»¶</h4>
<p>ç”±äº frp ç›®å‰æ”¯æŒçš„åŠŸèƒ½å’Œé…ç½®é¡¹è¾ƒå¤šï¼Œæœªåœ¨æ–‡æ¡£ä¸­åˆ—å‡ºçš„åŠŸèƒ½å¯ä»¥ä»å®Œæ•´çš„ç¤ºä¾‹é…ç½®æ–‡ä»¶ä¸­å‘ç°ã€‚</p>
<p><a href="./conf/frps_full.ini">frps å®Œæ•´é…ç½®æ–‡ä»¶</a></p>
<p><a href="./conf/frpc_full.ini">frpc å®Œæ•´é…ç½®æ–‡ä»¶</a></p>
<h4>é…ç½®æ–‡ä»¶æ¨¡ç‰ˆæ¸²æŸ“</h4>
<p>é…ç½®æ–‡ä»¶æ”¯æŒä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡è¿›è¡Œæ¨¡ç‰ˆæ¸²æŸ“ï¼Œæ¨¡ç‰ˆæ ¼å¼é‡‡ç”¨ Go çš„æ ‡å‡†æ ¼å¼ã€‚</p>
<p>ç¤ºä¾‹é…ç½®å¦‚ä¸‹:</p>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = {{ .Envs.FRP_SERVER_ADDR }}
server_port = 7000

[ssh]
type = tcp
local_ip = 127.0.0.1
local_port = 22
remote_port = {{ .Envs.FRP_SSH_REMOTE_PORT }}
</code></pre>
<p>å¯åŠ¨ frpc ç¨‹åº:</p>
<pre><code>export FRP_SERVER_ADDR="x.x.x.x"
export FRP_SSH_REMOTE_PORT="6000"
./frpc -c ./frpc.ini
</code></pre>
<p>frpc ä¼šè‡ªåŠ¨ä½¿ç”¨ç¯å¢ƒå˜é‡æ¸²æŸ“é…ç½®æ–‡ä»¶æ¨¡ç‰ˆï¼Œæ‰€æœ‰ç¯å¢ƒå˜é‡éœ€è¦ä»¥ <code>.Envs</code> ä¸ºå‰ç¼€ã€‚</p>
<h4>Dashboard</h4>
<p>é€šè¿‡æµè§ˆå™¨æŸ¥çœ‹ frp çš„çŠ¶æ€ä»¥åŠä»£ç†ç»Ÿè®¡ä¿¡æ¯å±•ç¤ºã€‚</p>
<p><strong>æ³¨ï¼šDashboard å°šæœªé’ˆå¯¹å¤§é‡çš„ proxy æ•°æ®å±•ç¤ºåšä¼˜åŒ–ï¼Œå¦‚æœå‡ºç° Dashboard è®¿é—®è¾ƒæ…¢çš„æƒ…å†µï¼Œè¯·ä¸è¦å¯ç”¨æ­¤åŠŸèƒ½ã€‚</strong></p>
<p>éœ€è¦åœ¨ frps.ini ä¸­æŒ‡å®š dashboard æœåŠ¡ä½¿ç”¨çš„ç«¯å£ï¼Œå³å¯å¼€å¯æ­¤åŠŸèƒ½ï¼š</p>
<pre><code class="language-ini">[common]
dashboard_port = 7500
# dashboard ç”¨æˆ·åå¯†ç ï¼Œé»˜è®¤éƒ½ä¸º admin
dashboard_user = admin
dashboard_pwd = admin
</code></pre>
<p>æ‰“å¼€æµè§ˆå™¨é€šè¿‡ <code>http://[server_addr]:7500</code> è®¿é—® dashboard ç•Œé¢ï¼Œç”¨æˆ·åå¯†ç é»˜è®¤ä¸º <code>admin</code>ã€‚</p>
<p><img src="/doc/pic/dashboard.png" alt="dashboard"></p>
<h4>Admin UI</h4>
<p>Admin UI å¯ä»¥å¸®åŠ©ç”¨æˆ·é€šè¿‡æµè§ˆå™¨æ¥æŸ¥è¯¢å’Œç®¡ç†å®¢æˆ·ç«¯çš„ proxy çŠ¶æ€å’Œé…ç½®ã€‚</p>
<p>éœ€è¦åœ¨ frpc.ini ä¸­æŒ‡å®š admin æœåŠ¡ä½¿ç”¨çš„ç«¯å£ï¼Œå³å¯å¼€å¯æ­¤åŠŸèƒ½ï¼š</p>
<pre><code class="language-ini">[common]
admin_addr = 127.0.0.1
admin_port = 7400
admin_user = admin
admin_pwd = admin
</code></pre>
<p>æ‰“å¼€æµè§ˆå™¨é€šè¿‡ <code>http://127.0.0.1:7400</code> è®¿é—® Admin UIï¼Œç”¨æˆ·åå¯†ç é»˜è®¤ä¸º <code>admin</code>ã€‚</p>
<p>å¦‚æœæƒ³è¦åœ¨å¤–ç½‘ç¯å¢ƒè®¿é—® Admin UIï¼Œå°† 7400 ç«¯å£æ˜ å°„å‡ºå»å³å¯ï¼Œä½†éœ€è¦é‡è§†å®‰å…¨é£é™©ã€‚</p>
<h4>ç›‘æ§</h4>
<p>frps å½“å¯ç”¨ Dashboard åï¼Œä¼šé»˜è®¤å¼€å¯å†…éƒ¨çš„ç›‘æ§ï¼Œæ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ¯æ¬¡é‡å¯è¿›ç¨‹åä¼šæ¸…ç©ºï¼Œç›‘æ§æ•°æ®å¯ä»¥é€šè¿‡ dashboard çš„åœ°å€å‘é€ HTTP è¯·æ±‚è·å–ã€‚</p>
<p>ç›®å‰è¿˜æ”¯æŒ Prometheus ä½œä¸ºå¯é€‰çš„ç›‘æ§ç³»ç»Ÿã€‚</p>
<h5>Prometheus</h5>
<p>åœ¨ <code>frps.ini</code> ä¸­å¯ç”¨ Dashboardï¼Œå¹¶ä¸”è®¾ç½® <code>enable_prometheus = true</code>ï¼Œåˆ™é€šè¿‡ <code>http://{dashboard_addr}/metrics</code> å¯ä»¥è·å–åˆ° Prometheus çš„ç›‘æ§æ•°æ®ã€‚</p>
<h4>å®¢æˆ·ç«¯èº«ä»½éªŒè¯</h4>
<p>ç›®å‰ frpc å’Œ frps ä¹‹é—´æ”¯æŒä¸¤ç§èº«ä»½éªŒè¯æ–¹å¼ï¼Œ<code>token</code> å’Œ <code>oidc</code>ã€‚</p>
<p>é€šè¿‡ <code>frpc.ini</code> å’Œ <code>frps.ini</code> ä¸­ <code>[common]</code> section çš„ <code>authentication_method</code> å‚æ•°é…ç½®éœ€è¦ä½¿ç”¨çš„éªŒè¯æ–¹æ³•ã€‚</p>
<p><code>authenticate_heartbeats = true</code> å°†ä¼šåœ¨æ¯ä¸€ä¸ªå¿ƒè·³åŒ…ä¸­é™„åŠ ä¸Šé‰´æƒä¿¡æ¯ã€‚</p>
<p><code>authenticate_new_work_conns = true</code> å°†ä¼šåœ¨æ¯æ¬¡å»ºç«‹æ–°çš„å·¥ä½œè¿æ¥æ—¶é™„åŠ ä¸Šé‰´æƒä¿¡æ¯ã€‚</p>
<h5>Token</h5>
<p>å½“ <code>authentication_method = token</code>ï¼Œå°†ä¼šå¯ç”¨åŸºäº token çš„éªŒè¯æ–¹å¼ã€‚</p>
<p>éœ€è¦åœ¨ <code>frpc.ini</code> å’Œ <code>frps.ini</code> çš„ <code>[common]</code> section ä¸­è®¾ç½®ç›¸åŒçš„ <code>token</code>ã€‚</p>
<h5>OIDC</h5>
<p>å½“ <code>authentication_method = oidc</code>ï¼Œå°†ä¼šå¯ç”¨åŸºäº OIDC çš„èº«ä»½éªŒè¯ã€‚</p>
<p>éªŒè¯æµç¨‹å‚è€ƒ <a href="https://tools.ietf.org/html/rfc6749#section-4.4">Client Credentials Grant</a></p>
<p>å¯ç”¨è¿™ä¸€éªŒè¯æ–¹å¼ï¼Œé…ç½® <code>frpc.ini</code> å’Œ <code>frps.ini</code> å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frps.ini
[common]
authentication_method = oidc
oidc_issuer = https://example-oidc-issuer.com/
oidc_audience = https://oidc-audience.com/.default
</code></pre>
<pre><code class="language-ini">[common]
authentication_method = oidc
oidc_client_id = 98692467-37de-409a-9fac-bb2585826f18 # Replace with OIDC client ID
oidc_client_secret = oidc_secret
oidc_audience = https://oidc-audience.com/.default
oidc_token_endpoint_url = https://example-oidc-endpoint.com/oauth2/v2.0/token
</code></pre>
<h4>åŠ å¯†ä¸å‹ç¼©</h4>
<p>è¿™ä¸¤ä¸ªåŠŸèƒ½é»˜è®¤æ˜¯ä¸å¼€å¯çš„ï¼Œéœ€è¦åœ¨ frpc.ini ä¸­é€šè¿‡é…ç½®æ¥ä¸ºæŒ‡å®šçš„ä»£ç†å¯ç”¨åŠ å¯†ä¸å‹ç¼©çš„åŠŸèƒ½ï¼Œå‹ç¼©ç®—æ³•ä½¿ç”¨ snappyï¼š</p>
<pre><code class="language-ini"># frpc.ini
[ssh]
type = tcp
local_port = 22
remote_port = 6000
use_encryption = true
use_compression = true
</code></pre>
<p>å¦‚æœå…¬å¸å†…ç½‘é˜²ç«å¢™å¯¹å¤–ç½‘è®¿é—®è¿›è¡Œäº†æµé‡è¯†åˆ«ä¸å±è”½ï¼Œä¾‹å¦‚ç¦æ­¢äº† ssh åè®®ç­‰ï¼Œé€šè¿‡è®¾ç½® <code>use_encryption = true</code>ï¼Œå°† frpc ä¸ frps ä¹‹é—´çš„é€šä¿¡å†…å®¹åŠ å¯†ä¼ è¾“ï¼Œå°†ä¼šæœ‰æ•ˆé˜²æ­¢æµé‡è¢«æ‹¦æˆªã€‚</p>
<p>å¦‚æœä¼ è¾“çš„æŠ¥æ–‡é•¿åº¦è¾ƒé•¿ï¼Œé€šè¿‡è®¾ç½® <code>use_compression = true</code> å¯¹ä¼ è¾“å†…å®¹è¿›è¡Œå‹ç¼©ï¼Œå¯ä»¥æœ‰æ•ˆå‡å° frpc ä¸ frps ä¹‹é—´çš„ç½‘ç»œæµé‡ï¼ŒåŠ å¿«æµé‡è½¬å‘é€Ÿåº¦ï¼Œä½†æ˜¯ä¼šé¢å¤–æ¶ˆè€—ä¸€äº› cpu èµ„æºã€‚</p>
<h5>TLS</h5>
<p>ä» v0.25.0 ç‰ˆæœ¬å¼€å§‹ frpc å’Œ frps ä¹‹é—´æ”¯æŒé€šè¿‡ TLS åè®®åŠ å¯†ä¼ è¾“ã€‚é€šè¿‡åœ¨ <code>frpc.ini</code> çš„ <code>common</code> ä¸­é…ç½® <code>tls_enable = true</code> æ¥å¯ç”¨æ­¤åŠŸèƒ½ï¼Œå®‰å…¨æ€§æ›´é«˜ã€‚</p>
<p>ä¸ºäº†ç«¯å£å¤ç”¨ï¼Œfrp å»ºç«‹ TLS è¿æ¥çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸º 0x17ã€‚</p>
<p>é€šè¿‡å°† frps.ini çš„ <code>[common]</code> ä¸­ <code>tls_only</code> è®¾ç½®ä¸º trueï¼Œå¯ä»¥å¼ºåˆ¶ frps åªæ¥å— TLS è¿æ¥ã€‚</p>
<p><strong>æ³¨æ„: å¯ç”¨æ­¤åŠŸèƒ½åé™¤ xtcp å¤–ï¼Œä¸éœ€è¦å†è®¾ç½® use_encryptionã€‚</strong></p>
<h4>å®¢æˆ·ç«¯çƒ­åŠ è½½é…ç½®æ–‡ä»¶</h4>
<p>å½“ä¿®æ”¹äº† frpc ä¸­çš„ä»£ç†é…ç½®ï¼Œå¯ä»¥é€šè¿‡ <code>frpc reload</code> å‘½ä»¤æ¥åŠ¨æ€åŠ è½½é…ç½®æ–‡ä»¶ï¼Œé€šå¸¸ä¼šåœ¨ 10 ç§’å†…å®Œæˆä»£ç†çš„æ›´æ–°ã€‚</p>
<p>å¯ç”¨æ­¤åŠŸèƒ½éœ€è¦åœ¨ frpc ä¸­å¯ç”¨ admin ç«¯å£ï¼Œç”¨äºæä¾› API æœåŠ¡ã€‚é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frpc.ini
[common]
admin_addr = 127.0.0.1
admin_port = 7400
</code></pre>
<p>ä¹‹åæ‰§è¡Œé‡å¯å‘½ä»¤ï¼š</p>
<p><code>frpc reload -c ./frpc.ini</code></p>
<p>ç­‰å¾…ä¸€æ®µæ—¶é—´åå®¢æˆ·ç«¯ä¼šæ ¹æ®æ–°çš„é…ç½®æ–‡ä»¶åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤ä»£ç†ã€‚</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ[common] ä¸­çš„å‚æ•°é™¤äº† start å¤–ç›®å‰æ— æ³•è¢«ä¿®æ”¹ã€‚</strong></p>
<h4>å®¢æˆ·ç«¯æŸ¥çœ‹ä»£ç†çŠ¶æ€</h4>
<p>frpc æ”¯æŒé€šè¿‡ <code>frpc status -c ./frpc.ini</code> å‘½ä»¤æŸ¥çœ‹ä»£ç†çš„çŠ¶æ€ä¿¡æ¯ï¼Œæ­¤åŠŸèƒ½éœ€è¦åœ¨ frpc ä¸­é…ç½® admin ç«¯å£ã€‚</p>
<h4>ç«¯å£ç™½åå•</h4>
<p>ä¸ºäº†é˜²æ­¢ç«¯å£è¢«æ»¥ç”¨ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®šå…è®¸å“ªäº›ç«¯å£è¢«ä½¿ç”¨ï¼Œåœ¨ frps.ini ä¸­é€šè¿‡ <code>allow_ports</code> æ¥æŒ‡å®šï¼š</p>
<pre><code class="language-ini"># frps.ini
[common]
allow_ports = 2000-3000,3001,3003,4000-50000
</code></pre>
<p><code>allow_ports</code> å¯ä»¥é…ç½®å…è®¸ä½¿ç”¨çš„æŸä¸ªæŒ‡å®šç«¯å£æˆ–è€…æ˜¯ä¸€ä¸ªèŒƒå›´å†…çš„æ‰€æœ‰ç«¯å£ï¼Œä»¥ <code>,</code> åˆ†éš”ï¼ŒæŒ‡å®šçš„èŒƒå›´ä»¥ <code>-</code> åˆ†éš”ã€‚</p>
<h4>ç«¯å£å¤ç”¨</h4>
<p>ç›®å‰ frps ä¸­çš„ <code>vhost_http_port</code> å’Œ <code>vhost_https_port</code> æ”¯æŒé…ç½®æˆå’Œ <code>bind_port</code> ä¸ºåŒä¸€ä¸ªç«¯å£ï¼Œfrps ä¼šå¯¹è¿æ¥çš„åè®®è¿›è¡Œåˆ†æï¼Œä¹‹åè¿›è¡Œä¸åŒçš„å¤„ç†ã€‚</p>
<p>ä¾‹å¦‚åœ¨æŸäº›é™åˆ¶è¾ƒä¸¥æ ¼çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œå¯ä»¥å°† <code>bind_port</code> å’Œ <code>vhost_https_port</code> éƒ½è®¾ç½®ä¸º 443ã€‚</p>
<p>åç»­ä¼šå°è¯•å…è®¸å¤šä¸ª proxy ç»‘å®šåŒä¸€ä¸ªè¿œç«¯ç«¯å£çš„ä¸åŒåè®®ã€‚</p>
<h4>é™é€Ÿ</h4>
<h5>ä»£ç†é™é€Ÿ</h5>
<p>ç›®å‰æ”¯æŒåœ¨å®¢æˆ·ç«¯çš„ä»£ç†é…ç½®ä¸­è®¾ç½®ä»£ç†çº§åˆ«çš„é™é€Ÿï¼Œé™åˆ¶å•ä¸ª proxy å¯ä»¥å ç”¨çš„å¸¦å®½ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[ssh]
type = tcp
local_port = 22
remote_port = 6000
bandwidth_limit = 1MB
</code></pre>
<p>åœ¨ä»£ç†é…ç½®ä¸­å¢åŠ  <code>bandwidth_limit</code> å­—æ®µå¯ç”¨æ­¤åŠŸèƒ½ï¼Œç›®å‰ä»…æ”¯æŒ <code>MB</code> å’Œ <code>KB</code> å•ä½ã€‚</p>
<h4>TCP å¤šè·¯å¤ç”¨</h4>
<p>ä» v0.10.0 ç‰ˆæœ¬å¼€å§‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´çš„è¿æ¥æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œä¸å†éœ€è¦ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·è¯·æ±‚åˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œä½¿è¿æ¥å»ºç«‹çš„å»¶è¿Ÿé™ä½ï¼Œå¹¶ä¸”é¿å…äº†å¤§é‡æ–‡ä»¶æè¿°ç¬¦çš„å ç”¨ï¼Œä½¿ frp å¯ä»¥æ‰¿è½½æ›´é«˜çš„å¹¶å‘æ•°ã€‚</p>
<p>è¯¥åŠŸèƒ½é»˜è®¤å¯ç”¨ï¼Œå¦‚éœ€å…³é—­ï¼Œå¯ä»¥åœ¨ frps.ini å’Œ frpc.ini ä¸­é…ç½®ï¼Œè¯¥é…ç½®é¡¹åœ¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¿…é¡»ä¸€è‡´ï¼š</p>
<pre><code class="language-ini"># frps.ini å’Œ frpc.ini ä¸­
[common]
tcp_mux = false
</code></pre>
<h4>åº•å±‚é€šä¿¡å¯é€‰ kcp åè®®</h4>
<p>åº•å±‚é€šä¿¡åè®®æ”¯æŒé€‰æ‹© kcp åè®®ï¼Œåœ¨å¼±ç½‘ç¯å¢ƒä¸‹ä¼ è¾“æ•ˆç‡æå‡æ˜æ˜¾ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€äº›é¢å¤–çš„æµé‡æ¶ˆè€—ã€‚</p>
<p>å¼€å¯ kcp åè®®æ”¯æŒï¼š</p>
<ol>
<li>åœ¨ frps.ini ä¸­å¯ç”¨ kcp åè®®æ”¯æŒï¼ŒæŒ‡å®šä¸€ä¸ª udp ç«¯å£ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼š</li>
</ol>
<pre><code class="language-ini"># frps.ini
[common]
bind_port = 7000
# kcp ç»‘å®šçš„æ˜¯ udp ç«¯å£ï¼Œå¯ä»¥å’Œ bind_port ä¸€æ ·
kcp_bind_port = 7000
</code></pre>
<ol start="2">
<li>åœ¨ frpc.ini æŒ‡å®šéœ€è¦ä½¿ç”¨çš„åè®®ç±»å‹ï¼Œç›®å‰åªæ”¯æŒ tcp å’Œ kcpã€‚å…¶ä»–ä»£ç†é…ç½®ä¸éœ€è¦å˜æ›´ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
# server_port æŒ‡å®šä¸º frps çš„ kcp_bind_port
server_port = 7000
protocol = kcp
</code></pre>
<ol start="3">
<li>åƒä¹‹å‰ä¸€æ ·ä½¿ç”¨ frpï¼Œéœ€è¦æ³¨æ„å¼€æ”¾ç›¸å…³æœºå™¨ä¸Šçš„ udp çš„ç«¯å£çš„è®¿é—®æƒé™ã€‚</li>
</ol>
<h4>è¿æ¥æ± </h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·è¯·æ±‚å»ºç«‹è¿æ¥åï¼Œfrps æ‰ä¼šè¯·æ±‚ frpc ä¸»åŠ¨ä¸åç«¯æœåŠ¡å»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚å½“ä¸ºæŒ‡å®šçš„ä»£ç†å¯ç”¨è¿æ¥æ± åï¼Œfrp ä¼šé¢„å…ˆå’Œåç«¯æœåŠ¡å»ºç«‹èµ·æŒ‡å®šæ•°é‡çš„è¿æ¥ï¼Œæ¯æ¬¡æ¥æ”¶åˆ°ç”¨æˆ·è¯·æ±‚åï¼Œä¼šä»è¿æ¥æ± ä¸­å–å‡ºä¸€ä¸ªè¿æ¥å’Œç”¨æˆ·è¿æ¥å…³è”èµ·æ¥ï¼Œé¿å…äº†ç­‰å¾…ä¸åç«¯æœåŠ¡å»ºç«‹è¿æ¥ä»¥åŠ frpc å’Œ frps ä¹‹é—´ä¼ é€’æ§åˆ¶ä¿¡æ¯çš„æ—¶é—´ã€‚</p>
<p>è¿™ä¸€åŠŸèƒ½æ¯”è¾ƒé€‚åˆæœ‰å¤§é‡çŸ­è¿æ¥è¯·æ±‚æ—¶å¼€å¯ã€‚</p>
<ol>
<li>é¦–å…ˆå¯ä»¥åœ¨ frps.ini ä¸­è®¾ç½®æ¯ä¸ªä»£ç†å¯ä»¥åˆ›å»ºçš„è¿æ¥æ± ä¸Šé™ï¼Œé¿å…å¤§é‡èµ„æºå ç”¨ï¼Œå®¢æˆ·ç«¯è®¾ç½®è¶…è¿‡æ­¤é…ç½®åä¼šè¢«è°ƒæ•´åˆ°å½“å‰å€¼ï¼š</li>
</ol>
<pre><code class="language-ini"># frps.ini
[common]
max_pool_count = 5
</code></pre>
<ol start="2">
<li>åœ¨ frpc.ini ä¸­ä¸ºå®¢æˆ·ç«¯å¯ç”¨è¿æ¥æ± ï¼ŒæŒ‡å®šé¢„åˆ›å»ºè¿æ¥çš„æ•°é‡ï¼š</li>
</ol>
<pre><code class="language-ini"># frpc.ini
[common]
pool_count = 1
</code></pre>
<h4>è´Ÿè½½å‡è¡¡</h4>
<p>å¯ä»¥å°†å¤šä¸ªç›¸åŒç±»å‹çš„ proxy åŠ å…¥åˆ°åŒä¸€ä¸ª group ä¸­ï¼Œä»è€Œå®ç°è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ã€‚</p>
<p>ç›®å‰åªæ”¯æŒ TCP å’Œ HTTP ç±»å‹çš„ proxyã€‚</p>
<pre><code class="language-ini"># frpc.ini
[test1]
type = tcp
local_port = 8080
remote_port = 80
group = web
group_key = 123

[test2]
type = tcp
local_port = 8081
remote_port = 80
group = web
group_key = 123
</code></pre>
<p>ç”¨æˆ·è¿æ¥ frps æœåŠ¡å™¨çš„ 80 ç«¯å£ï¼Œfrps ä¼šå°†æ¥æ”¶åˆ°çš„ç”¨æˆ·è¿æ¥éšæœºåˆ†å‘ç»™å…¶ä¸­ä¸€ä¸ªå­˜æ´»çš„ proxyã€‚è¿™æ ·å¯ä»¥åœ¨ä¸€å° frpc æœºå™¨æŒ‚æ‰åä»ç„¶æœ‰å…¶ä»–èŠ‚ç‚¹èƒ½å¤Ÿæä¾›æœåŠ¡ã€‚</p>
<p>TCP ç±»å‹ä»£ç†è¦æ±‚ <code>group_key</code> ç›¸åŒï¼Œåšæƒé™éªŒè¯ï¼Œä¸” <code>remote_port</code> ç›¸åŒã€‚</p>
<p>HTTP ç±»å‹ä»£ç†è¦æ±‚ <code>group_key, custom_domains æˆ– subdomain å’Œ locations</code> ç›¸åŒã€‚</p>
<h4>å¥åº·æ£€æŸ¥</h4>
<p>é€šè¿‡ç»™ proxy åŠ ä¸Šå¥åº·æ£€æŸ¥çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨è¦åå‘ä»£ç†çš„æœåŠ¡å‡ºç°æ•…éšœæ—¶ï¼Œå°†è¿™ä¸ªæœåŠ¡ä» frps ä¸­æ‘˜é™¤ï¼Œæ­é…è´Ÿè½½å‡è¡¡çš„åŠŸèƒ½ï¼Œå¯ä»¥ç”¨æ¥å®ç°é«˜å¯ç”¨çš„æ¶æ„ï¼Œé¿å…æœåŠ¡å•ç‚¹æ•…éšœã€‚</p>
<p>åœ¨æ¯ä¸€ä¸ª proxy çš„é…ç½®ä¸‹åŠ ä¸Š <code>health_check_type = {type}</code> æ¥å¯ç”¨å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚</p>
<p><strong>type</strong> ç›®å‰å¯é€‰ tcp å’Œ httpã€‚</p>
<p>tcp åªè¦èƒ½å¤Ÿå»ºç«‹è¿æ¥åˆ™è®¤ä¸ºæœåŠ¡æ­£å¸¸ï¼Œhttp ä¼šå‘é€ä¸€ä¸ª http è¯·æ±‚ï¼ŒæœåŠ¡éœ€è¦è¿”å› 2xx çš„çŠ¶æ€ç æ‰ä¼šè¢«è®¤ä¸ºæ­£å¸¸ã€‚</p>
<p>tcp ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frpc.ini
[test1]
type = tcp
local_port = 22
remote_port = 6000
# å¯ç”¨å¥åº·æ£€æŸ¥ï¼Œç±»å‹ä¸º tcp
health_check_type = tcp
# å»ºç«‹è¿æ¥è¶…æ—¶æ—¶é—´ä¸º 3 ç§’
health_check_timeout_s = 3
# è¿ç»­ 3 æ¬¡æ£€æŸ¥å¤±è´¥ï¼Œæ­¤ proxy ä¼šè¢«æ‘˜é™¤
health_check_max_failed = 3
# æ¯éš” 10 ç§’è¿›è¡Œä¸€æ¬¡å¥åº·æ£€æŸ¥
health_check_interval_s = 10
</code></pre>
<p>http ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = http
local_ip = 127.0.0.1
local_port = 80
custom_domains = test.yourdomain.com
# å¯ç”¨å¥åº·æ£€æŸ¥ï¼Œç±»å‹ä¸º http
health_check_type = http
# å¥åº·æ£€æŸ¥å‘é€ http è¯·æ±‚çš„ urlï¼Œåç«¯æœåŠ¡éœ€è¦è¿”å› 2xx çš„ http çŠ¶æ€ç 
health_check_url = /status
health_check_interval_s = 10
health_check_max_failed = 3
health_check_timeout_s = 3
</code></pre>
<h4>ä¿®æ”¹ Host Header</h4>
<p>é€šå¸¸æƒ…å†µä¸‹ frp ä¸ä¼šä¿®æ”¹è½¬å‘çš„ä»»ä½•æ•°æ®ã€‚ä½†æœ‰ä¸€äº›åç«¯æœåŠ¡ä¼šæ ¹æ® http è¯·æ±‚ header ä¸­çš„ host å­—æ®µæ¥å±•ç°ä¸åŒçš„ç½‘ç«™ï¼Œä¾‹å¦‚ nginx çš„è™šæ‹Ÿä¸»æœºæœåŠ¡ï¼Œå¯ç”¨ host-header çš„ä¿®æ”¹åŠŸèƒ½å¯ä»¥åŠ¨æ€ä¿®æ”¹ http è¯·æ±‚ä¸­çš„ host å­—æ®µã€‚è¯¥åŠŸèƒ½ä»…é™äº http ç±»å‹çš„ä»£ç†ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = http
local_port = 80
custom_domains = test.yourdomain.com
host_header_rewrite = dev.yourdomain.com
</code></pre>
<p>åŸæ¥ http è¯·æ±‚ä¸­çš„ host å­—æ®µ <code>test.yourdomain.com</code> è½¬å‘åˆ°åç«¯æœåŠ¡æ—¶ä¼šè¢«æ›¿æ¢ä¸º <code>dev.yourdomain.com</code>ã€‚</p>
<h4>è®¾ç½® HTTP è¯·æ±‚çš„ header</h4>
<p>å¯¹äº <code>type = http</code> çš„ä»£ç†ï¼Œå¯ä»¥è®¾ç½®åœ¨è½¬å‘ä¸­åŠ¨æ€æ·»åŠ çš„ header å‚æ•°ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = http
local_port = 80
custom_domains = test.yourdomain.com
host_header_rewrite = dev.yourdomain.com
header_X-From-Where = frp
</code></pre>
<p>å¯¹äºå‚æ•°é…ç½®ä¸­æ‰€æœ‰ä»¥ <code>header_</code> å¼€å¤´çš„å‚æ•°(æ”¯æŒåŒæ—¶é…ç½®å¤šä¸ª)ï¼Œéƒ½ä¼šè¢«æ·»åŠ åˆ° http è¯·æ±‚çš„ header ä¸­ï¼Œæ ¹æ®å¦‚ä¸Šçš„é…ç½®ï¼Œä¼šåœ¨è¯·æ±‚çš„ header ä¸­åŠ ä¸Š <code>X-From-Where: frp</code>ã€‚</p>
<h4>è·å–ç”¨æˆ·çœŸå® IP</h4>
<h5>HTTP X-Forwarded-For</h5>
<p>ç›®å‰åªæœ‰ <strong>http</strong> ç±»å‹çš„ä»£ç†æ”¯æŒè¿™ä¸€åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ç”¨æˆ·è¯·æ±‚çš„ header ä¸­çš„ <code>X-Forwarded-For</code> æ¥è·å–ç”¨æˆ·çœŸå® IPï¼Œé»˜è®¤å¯ç”¨ã€‚</p>
<h5>Proxy Protocol</h5>
<p>frp æ”¯æŒé€šè¿‡ <strong>Proxy Protocol</strong> åè®®æ¥ä¼ é€’ç»è¿‡ frp ä»£ç†çš„è¯·æ±‚çš„çœŸå® IPï¼Œæ­¤åŠŸèƒ½æ”¯æŒæ‰€æœ‰ä»¥ TCP ä¸ºåº•å±‚åè®®çš„ç±»å‹ï¼Œä¸æ”¯æŒ UDPã€‚</p>
<p><strong>Proxy Protocol</strong> åŠŸèƒ½å¯ç”¨åï¼Œfrpc åœ¨å’Œæœ¬åœ°æœåŠ¡å»ºç«‹è¿æ¥åï¼Œä¼šå…ˆå‘é€ä¸€æ®µ <strong>Proxy Protocol</strong> çš„åè®®å†…å®¹ç»™æœ¬åœ°æœåŠ¡ï¼Œæœ¬åœ°æœåŠ¡é€šè¿‡è§£æè¿™ä¸€å†…å®¹å¯ä»¥è·å¾—è®¿é—®ç”¨æˆ·çš„çœŸå® IPã€‚æ‰€ä»¥ä¸ä»…ä»…æ˜¯ HTTP æœåŠ¡ï¼Œä»»ä½•çš„ TCP æœåŠ¡ï¼Œåªè¦æ”¯æŒè¿™ä¸€åè®®ï¼Œéƒ½å¯ä»¥è·å¾—ç”¨æˆ·çš„çœŸå® IP åœ°å€ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä»£ç†é…ç½®ä¸­å¦‚æœè¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œéœ€è¦æœ¬åœ°çš„æœåŠ¡èƒ½å¤Ÿæ”¯æŒ <strong>Proxy Protocol</strong> è¿™ä¸€åè®®ï¼Œç›®å‰ nginx å’Œ haproxy éƒ½èƒ½å¤Ÿå¾ˆå¥½çš„æ”¯æŒã€‚</p>
<p>è¿™é‡Œä»¥ https ç±»å‹ä¸ºä¾‹:</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = https
local_port = 443
custom_domains = test.yourdomain.com

# ç›®å‰æ”¯æŒ v1 å’Œ v2 ä¸¤ä¸ªç‰ˆæœ¬çš„ proxy protocol åè®®ã€‚
proxy_protocol_version = v2
</code></pre>
<p>åªéœ€è¦åœ¨ä»£ç†é…ç½®ä¸­å¢åŠ ä¸€è¡Œ <code>proxy_protocol_version = v2</code> å³å¯å¼€å¯æ­¤åŠŸèƒ½ã€‚</p>
<p>æœ¬åœ°çš„ https æœåŠ¡å¯ä»¥é€šè¿‡åœ¨ nginx çš„é…ç½®ä¸­å¯ç”¨ <strong>Proxy Protocol</strong> çš„è§£æå¹¶å°†ç»“æœè®¾ç½®åœ¨ <code>X-Real-IP</code> è¿™ä¸ª Header ä¸­å°±å¯ä»¥åœ¨è‡ªå·±çš„ Web æœåŠ¡ä¸­é€šè¿‡ <code>X-Real-IP</code> è·å–åˆ°ç”¨æˆ·çš„çœŸå® IPã€‚</p>
<h4>é€šè¿‡å¯†ç ä¿æŠ¤ä½ çš„ web æœåŠ¡</h4>
<p>ç”±äºæ‰€æœ‰å®¢æˆ·ç«¯å…±ç”¨ä¸€ä¸ª frps çš„ http æœåŠ¡ç«¯å£ï¼Œä»»ä½•çŸ¥é“ä½ çš„åŸŸåå’Œ url çš„äººéƒ½èƒ½è®¿é—®åˆ°ä½ éƒ¨ç½²åœ¨å†…ç½‘çš„ web æœåŠ¡ï¼Œä½†æ˜¯åœ¨æŸäº›åœºæ™¯ä¸‹éœ€è¦ç¡®ä¿åªæœ‰é™å®šçš„ç”¨æˆ·æ‰èƒ½è®¿é—®ã€‚</p>
<p>frp æ”¯æŒé€šè¿‡ HTTP Basic Auth æ¥ä¿æŠ¤ä½ çš„ web æœåŠ¡ï¼Œä½¿ç”¨æˆ·éœ€è¦é€šè¿‡ç”¨æˆ·åå’Œå¯†ç æ‰èƒ½è®¿é—®åˆ°ä½ çš„æœåŠ¡ã€‚</p>
<p>è¯¥åŠŸèƒ½ç›®å‰ä»…é™äº http ç±»å‹çš„ä»£ç†ï¼Œéœ€è¦åœ¨ frpc çš„ä»£ç†é…ç½®ä¸­æ·»åŠ ç”¨æˆ·åå’Œå¯†ç çš„è®¾ç½®ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = http
local_port = 80
custom_domains = test.yourdomain.com
http_user = abc
http_pwd = abc
</code></pre>
<p>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>http://test.yourdomain.com</code>ï¼Œéœ€è¦è¾“å…¥é…ç½®çš„ç”¨æˆ·åå’Œå¯†ç æ‰èƒ½è®¿é—®ã€‚</p>
<h4>è‡ªå®šä¹‰äºŒçº§åŸŸå</h4>
<p>åœ¨å¤šäººåŒæ—¶ä½¿ç”¨ä¸€ä¸ª frps æ—¶ï¼Œé€šè¿‡è‡ªå®šä¹‰äºŒçº§åŸŸåçš„æ–¹å¼æ¥ä½¿ç”¨ä¼šæ›´åŠ æ–¹ä¾¿ã€‚</p>
<p>é€šè¿‡åœ¨ frps çš„é…ç½®æ–‡ä»¶ä¸­é…ç½® <code>subdomain_host</code>ï¼Œå°±å¯ä»¥å¯ç”¨è¯¥ç‰¹æ€§ã€‚ä¹‹ååœ¨ frpc çš„ httpã€https ç±»å‹çš„ä»£ç†ä¸­å¯ä»¥ä¸é…ç½® <code>custom_domains</code>ï¼Œè€Œæ˜¯é…ç½®ä¸€ä¸ª <code>subdomain</code> å‚æ•°ã€‚</p>
<p>åªéœ€è¦å°† <code>*.{subdomain_host}</code> è§£æåˆ° frps æ‰€åœ¨æœåŠ¡å™¨ã€‚ä¹‹åç”¨æˆ·å¯ä»¥é€šè¿‡ <code>subdomain</code> è‡ªè¡ŒæŒ‡å®šè‡ªå·±çš„ web æœåŠ¡æ‰€éœ€è¦ä½¿ç”¨çš„äºŒçº§åŸŸåï¼Œé€šè¿‡ <code>{subdomain}.{subdomain_host}</code> æ¥è®¿é—®è‡ªå·±çš„ web æœåŠ¡ã€‚</p>
<pre><code class="language-ini"># frps.ini
[common]
subdomain_host = frps.com
</code></pre>
<p>å°†æ³›åŸŸå <code>*.frps.com</code> è§£æåˆ° frps æ‰€åœ¨æœåŠ¡å™¨çš„ IP åœ°å€ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[web]
type = http
local_port = 80
subdomain = test
</code></pre>
<p>frps å’Œ frpc éƒ½å¯åŠ¨æˆåŠŸåï¼Œé€šè¿‡ <code>test.frps.com</code> å°±å¯ä»¥è®¿é—®åˆ°å†…ç½‘çš„ web æœåŠ¡ã€‚</p>
<p><strong>æ³¨ï¼šå¦‚æœ frps é…ç½®äº† <code>subdomain_host</code>ï¼Œåˆ™ <code>custom_domains</code> ä¸­ä¸èƒ½æ˜¯å±äº <code>subdomain_host</code> çš„å­åŸŸåæˆ–è€…æ³›åŸŸåã€‚</strong></p>
<p>åŒä¸€ä¸ª http æˆ– https ç±»å‹çš„ä»£ç†ä¸­ <code>custom_domains</code>  å’Œ <code>subdomain</code> å¯ä»¥åŒæ—¶é…ç½®ã€‚</p>
<h4>URL è·¯ç”±</h4>
<p>frp æ”¯æŒæ ¹æ®è¯·æ±‚çš„ URL è·¯å¾„è·¯ç”±è½¬å‘åˆ°ä¸åŒçš„åç«¯æœåŠ¡ã€‚</p>
<p>é€šè¿‡é…ç½®æ–‡ä»¶ä¸­çš„ <code>locations</code> å­—æ®µæŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª proxy èƒ½å¤ŸåŒ¹é…çš„ URL å‰ç¼€(ç›®å‰ä»…æ”¯æŒæœ€å¤§å‰ç¼€åŒ¹é…ï¼Œä¹‹åä¼šè€ƒè™‘æ­£åˆ™åŒ¹é…)ã€‚ä¾‹å¦‚æŒ‡å®š <code>locations = /news</code>ï¼Œåˆ™æ‰€æœ‰ URL ä»¥ <code>/news</code> å¼€å¤´çš„è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ°è¿™ä¸ªæœåŠ¡ã€‚</p>
<pre><code class="language-ini"># frpc.ini
[web01]
type = http
local_port = 80
custom_domains = web.yourdomain.com
locations = /

[web02]
type = http
local_port = 81
custom_domains = web.yourdomain.com
locations = /news,/about
</code></pre>
<p>æŒ‰ç…§ä¸Šè¿°çš„ç¤ºä¾‹é…ç½®åï¼Œ<code>web.yourdomain.com</code> è¿™ä¸ªåŸŸåä¸‹æ‰€æœ‰ä»¥ <code>/news</code> ä»¥åŠ <code>/about</code> ä½œä¸ºå‰ç¼€çš„ URL è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘åˆ° web02ï¼Œå…¶ä½™çš„è¯·æ±‚ä¼šè¢«è½¬å‘åˆ° web01ã€‚</p>
<h4>TCP ç«¯å£å¤ç”¨ç±»å‹</h4>
<p>frp æ”¯æŒå°†å•ä¸ªç«¯å£æ”¶åˆ°çš„è¿æ¥è·¯ç”±åˆ°ä¸åŒçš„ä»£ç†ï¼Œç±»ä¼¼ <code>vhost_http_port</code> å’Œ <code>vhost_https_port</code>ã€‚</p>
<p>ç›®å‰æ”¯æŒçš„å¤ç”¨å™¨åªæœ‰ <code>httpconnect</code>ã€‚</p>
<p>å½“åœ¨ <code>frps.ini</code> çš„ <code>[common]</code> ä¸­è®¾ç½® <code>tcpmux_httpconnect_port</code>ï¼Œfrps å°†ä¼šç›‘å¬åœ¨è¿™ä¸ªç«¯å£ï¼Œæ¥æ”¶ HTTP CONNECT è¯·æ±‚ã€‚</p>
<p>frps ä¼šæ ¹æ® HTTP CONNECT è¯·æ±‚ä¸­çš„ host è·¯ç”±åˆ°ä¸åŒçš„åç«¯ä»£ç†ã€‚</p>
<p>ç¤ºä¾‹é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frps.ini
[common]
bind_port = 7000
tcpmux_httpconnect_port = 1337
</code></pre>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000

[proxy1]
type = tcpmux
multiplexer = httpconnect
custom_domains = test1

[proxy2]
type = tcpmux
multiplexer = httpconnect
custom_domains = test2
</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„é…ç½®ï¼Œfrps å¦‚æœæ¥æ”¶åˆ° HTTP CONNECT è¯·æ±‚å†…å®¹:</p>
<pre><code>CONNECT test1 HTTP/1.1\r\n\r\n
</code></pre>
<p>è¯¥è¿æ¥å°†ä¼šè¢«è·¯ç”±åˆ° proxy1 ã€‚</p>
<h4>é€šè¿‡ä»£ç†è¿æ¥ frps</h4>
<p>åœ¨åªèƒ½é€šè¿‡ä»£ç†è®¿é—®å¤–ç½‘çš„ç¯å¢ƒå†…ï¼Œfrpc æ”¯æŒé€šè¿‡ HTTP PROXY å’Œ frps è¿›è¡Œé€šä¿¡ã€‚</p>
<p>å¯ä»¥é€šè¿‡è®¾ç½® <code>HTTP_PROXY</code> ç³»ç»Ÿç¯å¢ƒå˜é‡æˆ–è€…é€šè¿‡åœ¨ frpc çš„é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>http_proxy</code> å‚æ•°æ¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚</p>
<p>ä»…åœ¨ <code>protocol = tcp</code> æ—¶ç”Ÿæ•ˆã€‚</p>
<pre><code class="language-ini"># frpc.ini
[common]
server_addr = x.x.x.x
server_port = 7000
http_proxy = http://user:pwd@192.168.1.128:8080
</code></pre>
<h4>èŒƒå›´ç«¯å£æ˜ å°„</h4>
<p>åœ¨ frpc çš„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥æŒ‡å®šæ˜ å°„å¤šä¸ªç«¯å£ï¼Œç›®å‰åªæ”¯æŒ tcp å’Œ udp çš„ç±»å‹ã€‚</p>
<p>è¿™ä¸€åŠŸèƒ½é€šè¿‡ <code>range:</code> æ®µè½æ ‡è®°æ¥å®ç°ï¼Œå®¢æˆ·ç«¯ä¼šè§£æè¿™ä¸ªæ ‡è®°ä¸­çš„é…ç½®ï¼Œå°†å…¶æ‹†åˆ†æˆå¤šä¸ª proxyï¼Œæ¯ä¸€ä¸ª proxy ä»¥æ•°å­—ä¸ºåç¼€å‘½åã€‚</p>
<p>ä¾‹å¦‚è¦æ˜ å°„æœ¬åœ° 6000-6005, 6007 è¿™6ä¸ªç«¯å£ï¼Œä¸»è¦é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="language-ini"># frpc.ini
[range:test_tcp]
type = tcp
local_ip = 127.0.0.1
local_port = 6000-6006,6007
remote_port = 6000-6006,6007
</code></pre>
<p>å®é™…è¿æ¥æˆåŠŸåä¼šåˆ›å»º 8 ä¸ª proxyï¼Œå‘½åä¸º <code>test_tcp_0, test_tcp_1 ... test_tcp_7</code>ã€‚</p>
<h4>å®¢æˆ·ç«¯æ’ä»¶</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œfrpc åªä¼šè½¬å‘è¯·æ±‚åˆ°æœ¬åœ° tcp æˆ– udp ç«¯å£ã€‚</p>
<p>å®¢æˆ·ç«¯æ’ä»¶æ¨¡å¼æ˜¯ä¸ºäº†åœ¨å®¢æˆ·ç«¯æä¾›æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½ï¼Œç›®å‰å†…ç½®çš„æ’ä»¶æœ‰ <code>unix_domain_socket</code>ã€<code>http_proxy</code>ã€<code>socks5</code>ã€<code>static_file</code>ã€‚å…·ä½“ä½¿ç”¨æ–¹å¼è¯·æŸ¥çœ‹<a href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B">ä½¿ç”¨ç¤ºä¾‹</a>ã€‚</p>
<p>é€šè¿‡ <code>plugin</code> æŒ‡å®šéœ€è¦ä½¿ç”¨çš„æ’ä»¶ï¼Œæ’ä»¶çš„é…ç½®å‚æ•°éƒ½ä»¥ <code>plugin_</code> å¼€å¤´ã€‚ä½¿ç”¨æ’ä»¶å <code>local_ip</code> å’Œ <code>local_port</code> ä¸å†éœ€è¦é…ç½®ã€‚</p>
<p>ä½¿ç”¨ <strong>http_proxy</strong> æ’ä»¶çš„ç¤ºä¾‹:</p>
<pre><code class="language-ini"># frpc.ini
[http_proxy]
type = tcp
remote_port = 6000
plugin = http_proxy
plugin_http_user = abc
plugin_http_passwd = abc
</code></pre>
<p><code>plugin_http_user</code> å’Œ <code>plugin_http_passwd</code> å³ä¸º <code>http_proxy</code> æ’ä»¶å¯é€‰çš„é…ç½®å‚æ•°ã€‚</p>
<h4>æœåŠ¡ç«¯ç®¡ç†æ’ä»¶</h4>
<p><a href="/doc/server_plugin_zh.md">ä½¿ç”¨è¯´æ˜</a></p>
<h3>å¼€å‘è®¡åˆ’</h3>
<p>è®¡åˆ’åœ¨åç»­ç‰ˆæœ¬ä¸­åŠ å…¥çš„åŠŸèƒ½ä¸ä¼˜åŒ–ï¼Œæ’åä¸åˆ†å…ˆåï¼Œå¦‚æœæœ‰å…¶ä»–åŠŸèƒ½å»ºè®®æ¬¢è¿åœ¨ <a href="https://github.com/fatedier/frp/issues">issues</a> ä¸­åé¦ˆã€‚</p>
<ul>
<li>frps è®°å½• http è¯·æ±‚æ—¥å¿—ã€‚</li>
</ul>
<h1>---------------- åˆ†å‰²çº¿ ä»¥ä¸‹æ˜¯ 0.21 ç‰ˆæœ¬æ—¶çš„è®°å½• ------------------------------------</h1>
<h1>Background Knowledge</h1>
<p><a href="https://blog.csdn.net/zhangguo5/article/details/77848658?utm_source=5ibc.net&#x26;utm_medium=referral">ä¸€åˆ†é’Ÿå®ç°å†…ç½‘ç©¿é€ï¼ˆngrokæœåŠ¡å™¨æ­å»ºï¼‰</a></p>
<h1>Source Code and Readme Document</h1>
<p><a href="https://github.com/fatedier/frp/blob/master/README_zh.md">github</a></p>
<h1>Server Install</h1>
<p><a href="https://blog.csdn.net/e_wsq/article/details/79405512">frpç®€æ˜“å®‰è£…é…ç½®è¯´æ˜</a></p>
<ol>
<li>download</li>
</ol>
<pre><code>wget https://github.com/fatedier/frp/releases/download/v0.21.0/frp_0.21.0_linux_amd64.tar.gz
</code></pre>
<ol start="2">
<li>unzip</li>
</ol>
<pre><code>tar zxvf frp_0.21.0_linux_amd64.tar.gz
</code></pre>
<ol start="3">
<li>config frps.ini</li>
<li>command</li>
</ol>
<pre><code>vim frps.ini
</code></pre>
<ul>
<li>content</li>
</ul>
<pre><code># frps.ini
[common]
bind_port = 7000
vhost_http_port = 80
</code></pre>
<ol start="4">
<li>start service</li>
</ol>
<pre><code>./frps -c ./frps.ini
</code></pre>
<blockquote>
<p>You may want to save above command as a sh batch file.</p>
</blockquote>
<pre><code>#!/bin/bash
# start frp service

./frps -c ./frps.ini
</code></pre>
<h2>Aliyun Config</h2>
<blockquote>
<p>è®¾ç½®é˜¿é‡Œäº‘ ECSï¼ˆxxx.xxx.xxx.xxxï¼‰ å®‰å…¨ç»„è§„åˆ™ï¼šå…è®¸ 7000 ç«¯å£ ä»¥åŠ 80 ç«¯å£
é˜¿é‡Œäº‘åŸŸåè§£æ å¢åŠ  A è®°å½•ï¼šwww.[domainname].com ==>xxx.xxx.xxx.xxx</p>
</blockquote>
<h2>Client Install</h2>
<ol>
<li>download</li>
<li>config frpc.ini</li>
</ol>
<pre><code># frpc.ini
[common]
server_addr = xxx.xxx.xxx.xxx
server_port = 7000

[web]
type = http
local_port = 3000
custom_domains = www.[domainname].com
</code></pre>
<blockquote>
<p>Above is the configuration about web server. Below is the configuration about the tcp (from Xiaoyi Zhu).</p>
</blockquote>
<pre><code># frpc.ini
[common]
server_addr = xxx.xxx.xxx.xxx
server_port = 7000

[unix_domain_socket]
type = tcp
remote_port = 3000
plugin = unix_domain_socket
plugin_unix_path = /var/run/docker.sock
</code></pre>
<ol start="3">
<li>start frp client</li>
</ol>
<pre><code>frpc -c frpc.ini
</code></pre>
<blockquote>
<p>You may want to save above command as a bat file in the same folder of frpc.ext and frpc.ini.</p>
</blockquote>
<h2>Test</h2>
<ol>
<li>Start Web Server from local machine and listen port 3000</li>
</ol>
<pre><code>node app
</code></pre>
<ol start="2">
<li>Open Web Site from Browser</li>
</ol>
<blockquote>
<p>Input '<a href="http://www.%5Bdomainname%5D.com:80">http://www.[domainname].com:80</a>' in browser url address box.</p>
</blockquote>
<h2>Subdomain</h2>
<p>If you want to use sub domain, here is the case:</p>
<pre><code># frps.ini
[common]
bind_port = 7000
vhost_http_port = 80
subdomain_host = [sub domain name].com
</code></pre>
<pre><code># frpc.ini
[common]
server_addr = xxx.xxx.xxx.xxx
server_port = 7000

[web]
type = http
local_port = 3000
subdomain = [site name]
</code></pre>
<p>Example</p>
<pre><code># frps.ini

[common]
bind_port = 7000
vhost_http_port = 80
subdomain_host = frp.xxxx.com
</code></pre>
<pre><code># frpc.ini

[common]
server_addr = 107.151.172.73
server_port = 7000

[web]
type = http
local_port = 3000
subdomain = atlantis
</code></pre>
<h2>æ³¨æ„</h2>
<blockquote>
<p>å¦‚æœæœåŠ¡å™¨ç‰ˆæœ¬å’Œå®¢æˆ·ç«¯ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œä¼šå¼•å‘æŠ¥é”™ï¼Œå¯¼è‡´å®¢æˆ·ç«¯æ— æ³•å¯åŠ¨</p>
</blockquote>
<blockquote>
<p>è¯·æ£€æŸ¥æœ€æ–°ç‰ˆæœ¬çš„è¯´æ˜æ–‡æ¡£</p>
</blockquote></div><div class="blog__SideColumn-sc-16e624u-2 eMQCOq"><div class="blog__Details-sc-16e624u-5 ehtuIq"><table style="width:100%;margin-bottom:1.2em"><tr><td><h5>ä¸»é¢˜ï¼š</h5><h6>devops</h6></td><td><h5>ç±»åˆ«ï¼š</h5><h6>æŒ‡å¯¼æ‰‹å†Œ</h6></td></tr><tr><td><h5>æ›´æ–°ï¼š</h5><h6>2021-01-30</h6></td><td><h5>åˆ›å»ºï¼š</h5><h6>2021-01-30</h6></td></tr><tr><td><h5>ä½œè€…ï¼š</h5><h6>Chris Wei</h6></td></tr></table><p class="blog__TagsList-sc-16e624u-4 dZNJvK"><span>æ ‡ç­¾&amp;å…³é”®å­—ï¼š</span><span class="blog__Tag-sc-16e624u-3 gnOjhs">frp</span><span class="blog__Tag-sc-16e624u-3 gnOjhs">å†…ç½‘ç©¿é€</span></p></div></div></div></div><div style="background:#262626;color:#fff" class="elements__Section-sc-1wyezfv-0 cwuJxU"><div class="sectionfooter__FooterArea-sc-1k72v7z-0 jkEQhy"><span>Â© 2021 WeReady. All rights reserved.</span><div><span role="img" aria-label="Phone">â˜ï¸</span><span>18621569380</span><span style="margin:0 .7em"></span><span role="img" aria-label="Email">ğŸ“§</span><span>yunzhi.wei@qq.com</span></div><span role="img" aria-label="Goodness">âœ¨ ğŸº ğŸ  â˜• ğŸŒˆ ğŸ‡¨ğŸ‡³  </span></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/20210130002_frp";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0eca59d2ee8c0828e3a6.js"],"app":["/app-bc5e397393304c21210d.js"],"component---src-pages-404-js":["/component---src-pages-404-js-5ae992dfca905617dfce.js"],"component---src-pages-index-js":["/component---src-pages-index-js-f2b0db63fd80c25f7ff7.js"],"component---src-pages-pepsi-js":["/component---src-pages-pepsi-js-866fb8a8682999689b2c.js"],"component---src-templates-blog-js":["/component---src-templates-blog-js-74b8cafac62daa61107d.js"]};/*]]>*/</script><script src="/polyfill-0eca59d2ee8c0828e3a6.js" nomodule=""></script><script src="/component---src-templates-blog-js-74b8cafac62daa61107d.js" async=""></script><script src="/a7ed190188128b6222399f6e5792102bea54436b-211e04e450f51c8f64da.js" async=""></script><script src="/styles-407fe62976dc5310c43e.js" async=""></script><script src="/app-bc5e397393304c21210d.js" async=""></script><script src="/framework-8e528b732ab2eaadb7b7.js" async=""></script><script src="/webpack-runtime-c07136e716a8635769c9.js" async=""></script></body></html>